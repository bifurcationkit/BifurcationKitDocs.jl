<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bifurcation detection (codim 1) · Bifurcation Analysis in Julia</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Bifurcation Analysis in Julia logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Bifurcation Analysis in Julia</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../guidelines/">Overview</a></li><li><a class="tocitem" href="../tutorials/tutorials/">Tutorials</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Functionalities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../plotting/">Plotting</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Nonlinear Equations (Newton)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../newton/">Krylov-Newton algorithm</a></li><li><a class="tocitem" href="../deflatedproblem/">Deflated problems</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Periodic Orbits</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../periodicOrbit/">Introduction</a></li><li><a class="tocitem" href="../periodicOrbitTrapeze/">Finite Differences</a></li><li><a class="tocitem" href="../periodicOrbitCollocation/">Collocation</a></li><li><a class="tocitem" href="../periodicOrbitShooting/">Shooting</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Symmetries / Waves</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../intro_wave/">Introduction</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Continuation methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../IntroContinuation/">Introduction</a></li><li><a class="tocitem" href="../Predictors/">Predictors / correctors</a></li><li><a class="tocitem" href="../PALC/">PALC</a></li><li><a class="tocitem" href="../MooreSpence/">Moore-Penrose Continuation</a></li><li><a class="tocitem" href="../DeflatedContinuation/">Deflated Continuation</a></li></ul></li><li><a class="tocitem" href="../EventCallback/">Event Handling and Callback</a></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox" checked/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">Bifurcations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Bifurcation detection (codim 1)</a><ul class="internal"><li><a class="tocitem" href="#Precise-detection-of-bifurcation-points-using-Bisection"><span>Precise detection of bifurcation points using Bisection</span></a></li><li><a class="tocitem" href="#Large-scale-computations"><span>Large scale computations</span></a></li><li><a class="tocitem" href="#List-of-detected-bifurcation-points"><span>List of detected bifurcation points</span></a></li><li><a class="tocitem" href="#Eigensolver"><span>Eigensolver</span></a></li><li><a class="tocitem" href="#Generic-bifurcation"><span>Generic bifurcation</span></a></li><li><a class="tocitem" href="#Fold-bifurcation"><span>Fold bifurcation</span></a></li><li><a class="tocitem" href="#Hopf-bifurcation"><span>Hopf bifurcation</span></a></li><li><a class="tocitem" href="#Bifurcations-of-periodic-orbits"><span>Bifurcations of periodic orbits</span></a></li></ul></li><li><a class="tocitem" href="../codim2Continuation/">Fold / Hopf Continuation (codim 2)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-8" type="checkbox"/><label class="tocitem" for="menuitem-4-8"><span class="docs-label">Normal form</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../simplebp/">Simple branch point</a></li><li><a class="tocitem" href="../nonsimplebp/">Non-simple branch point</a></li><li><a class="tocitem" href="../simplehopf/">Simple Hopf point</a></li><li><a class="tocitem" href="../cusp/">Cusp point</a></li><li><a class="tocitem" href="../bt/">Bogdanov-Takens point</a></li><li><a class="tocitem" href="../bautin/">Bautin point</a></li></ul></li><li><a class="tocitem" href="../branchswitching/">Branch switching</a></li><li><a class="tocitem" href="../BifurcationDiagram/">Bifurcation diagram</a></li><li><a class="tocitem" href="../constrainedproblem/">Constrained problem</a></li><li><a class="tocitem" href="../diffeq/">DiffEq wrapper</a></li><li><a class="tocitem" href="../iterator/">Iterator Interface</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Options</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../linearsolver/">Linear Solvers</a></li><li><a class="tocitem" href="../borderedlinearsolver/">Bordered linear solvers</a></li><li><a class="tocitem" href="../eigensolver/">Eigen Solvers</a></li><li><a class="tocitem" href="../Borderedarrays/">Bordered arrays</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Contributing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">Interfaces</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../interfaceLS/">Linear/Eigen Solvers</a></li><li><a class="tocitem" href="../interfacePred/">Predictor/Corrector</a></li><li><a class="tocitem" href="../interfaceFlow/">Flow</a></li></ul></li></ul></li><li><a class="tocitem" href="../faq/">Frequently Asked Questions</a></li><li><a class="tocitem" href="../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Functionalities</a></li><li><a class="is-disabled">Bifurcations</a></li><li class="is-active"><a href>Bifurcation detection (codim 1)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bifurcation detection (codim 1)</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/bifurcationkit/BifurcationKitDocs.jl/blob/master/docs/src/detectionBifurcation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Detection-of-bifurcation-points"><a class="docs-heading-anchor" href="#Detection-of-bifurcation-points">Detection of bifurcation points</a><a id="Detection-of-bifurcation-points-1"></a><a class="docs-heading-anchor-permalink" href="#Detection-of-bifurcation-points" title="Permalink"></a></h1><p>The bifurcations are detected during a call to <code>br, _ = continuation(F, J, u0, p0, lens, contParams::ContinuationPar;kwargs...)</code> by turning on the following flags:</p><ul><li><code>contParams.detectBifurcation = 2</code></li></ul><p>The bifurcation points are located by looking at the spectrum <strong>e.g.</strong> by monitoring the unstable eigenvalues. The eigenvalue λ is declared unstable if <code>real(λ) &gt; contParams.precisionStability</code>. The located bifurcation points are then returned in <code>br.specialpoint</code>. </p><h2 id="Precise-detection-of-bifurcation-points-using-Bisection"><a class="docs-heading-anchor" href="#Precise-detection-of-bifurcation-points-using-Bisection">Precise detection of bifurcation points using Bisection</a><a id="Precise-detection-of-bifurcation-points-using-Bisection-1"></a><a class="docs-heading-anchor-permalink" href="#Precise-detection-of-bifurcation-points-using-Bisection" title="Permalink"></a></h2><p>Note that the bifurcation points detected when <code>detectBifurcation = 2</code> can be rather <em>crude</em>  localization of the true bifurcation points. Indeed, we only signal that, in between two continuation steps <em>which can be large</em>, a (several) bifurcation has been detected. Hence, we only have a rough idea of where the bifurcation is located, unless your <code>dsmax</code> is very small... This can be improved as follows.</p><p>If you choose <code>detectBifurcation = 3</code>, a <strong>bisection algorithm</strong> is used to locate the bifurcation points more precisely. It means that we recursively track down the change in stability. Some options in <a href="../library/#BifurcationKit.ContinuationPar"><code>ContinuationPar</code></a> control this behavior:</p><ul><li><code>nInversion</code>: number of sign inversions in the bisection algorithm</li><li><code>maxBisectionSteps</code> maximum number of bisection steps</li><li><code>tolBisectionEigenvalue</code> tolerance on real part of eigenvalue to detect bifurcation points in the bisection steps</li></ul><p>If this is still not enough, you can use a Newton solver to locate them very precisely. See <a href="../codim2Continuation/#Fold-/-Hopf-Continuation">Fold / Hopf Continuation</a>.</p><div class="admonition is-success"><header class="admonition-header">Bisection mode</header><div class="admonition-body"><p>During the bisection, the eigensolvers are called like <code>eil(J, nev; bisection = true)</code> in order to be able to adapt the solver precision.</p></div></div><h2 id="Large-scale-computations"><a class="docs-heading-anchor" href="#Large-scale-computations">Large scale computations</a><a id="Large-scale-computations-1"></a><a class="docs-heading-anchor-permalink" href="#Large-scale-computations" title="Permalink"></a></h2><p>The user must specify the number of eigenvalues to be computed (like <code>nev = 10</code>) in the parameters <code>::ContinuationPar</code> passed to <code>continuation</code>. Note that <code>nev</code> is automatically incremented whenever a bifurcation point is detected <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>. Also, there is an option in <code>::ContinuationPar</code> to save (or not) the eigenvectors. This can be useful in memory limited environments (like on GPUs).</p><h2 id="List-of-detected-bifurcation-points"><a class="docs-heading-anchor" href="#List-of-detected-bifurcation-points">List of detected bifurcation points</a><a id="List-of-detected-bifurcation-points-1"></a><a class="docs-heading-anchor-permalink" href="#List-of-detected-bifurcation-points" title="Permalink"></a></h2><table><tr><th style="text-align: right">Bifurcation</th><th style="text-align: right">index used</th></tr><tr><td style="text-align: right">Fold</td><td style="text-align: right">fold</td></tr><tr><td style="text-align: right">Hopf</td><td style="text-align: right">hopf</td></tr><tr><td style="text-align: right">Bifurcation point (single eigenvalue stability change, Fold or branch point)</td><td style="text-align: right">bp</td></tr><tr><td style="text-align: right">Neimark-Sacker</td><td style="text-align: right">ns</td></tr><tr><td style="text-align: right">Period doubling</td><td style="text-align: right">pd</td></tr><tr><td style="text-align: right">Not documented</td><td style="text-align: right">nd</td></tr></table><h2 id="Eigensolver"><a class="docs-heading-anchor" href="#Eigensolver">Eigensolver</a><a id="Eigensolver-1"></a><a class="docs-heading-anchor-permalink" href="#Eigensolver" title="Permalink"></a></h2><p>The user must provide an eigensolver by setting <code>NewtonOptions.eigsolver</code> where <code>NewtonOptions</code> is located in the parameter <code>::ContinuationPar</code> passed to continuation. See <a href="../library/#BifurcationKit.NewtonPar"><code>NewtonPar</code></a> and <a href="../library/#BifurcationKit.ContinuationPar"><code>ContinuationPar</code></a> for more information on the composite type of the options passed to <code>newton</code> and <code>continuation</code>.</p><p>The eigensolver is highly problem dependent and this is why the user should implement / parametrize its own eigensolver through the abstract type <code>AbstractEigenSolver</code> or select one among <a href="../eigensolver/#List-of-implemented-eigen-solvers">List of implemented eigen solvers</a>.</p><h2 id="Generic-bifurcation"><a class="docs-heading-anchor" href="#Generic-bifurcation">Generic bifurcation</a><a id="Generic-bifurcation-1"></a><a class="docs-heading-anchor-permalink" href="#Generic-bifurcation" title="Permalink"></a></h2><p>By this we mean a change in the dimension of the Jacobian kernel. The detection of Branch point is done by analysis of the spectrum of the Jacobian.</p><p>The detection is triggered by setting <code>detectBifurcation &gt; 1</code> in the parameter <code>::ContinuationPar</code> passed to <code>continuation</code>. </p><h2 id="Fold-bifurcation"><a class="docs-heading-anchor" href="#Fold-bifurcation">Fold bifurcation</a><a id="Fold-bifurcation-1"></a><a class="docs-heading-anchor-permalink" href="#Fold-bifurcation" title="Permalink"></a></h2><p>The detection of <strong>Fold</strong> point is done by monitoring  the monotonicity of the parameter.</p><p>The detection is triggered by setting <code>detectFold = true</code> in the parameter <code>::ContinuationPar</code> passed to <code>continuation</code>. When a <strong>Fold</strong> is detected on a branch <code>br</code>, a point is added to <code>br.foldpoint</code> allowing for later refinement using the function <code>newtonFold</code>.</p><h2 id="Hopf-bifurcation"><a class="docs-heading-anchor" href="#Hopf-bifurcation">Hopf bifurcation</a><a id="Hopf-bifurcation-1"></a><a class="docs-heading-anchor-permalink" href="#Hopf-bifurcation" title="Permalink"></a></h2><p>The detection of Branch point is done by analysis of the spectrum of the Jacobian.</p><p>The detection is triggered by setting <code>detectBifurcation &gt; 1</code> in the parameter <code>::ContinuationPar</code> passed to <code>continuation</code>. When a <strong>Hopf point</strong> is detected, a point is added to <code>br.specialpoint</code> allowing for later refinement using the function <code>newtonHopf</code>.</p><h2 id="Bifurcations-of-periodic-orbits"><a class="docs-heading-anchor" href="#Bifurcations-of-periodic-orbits">Bifurcations of periodic orbits</a><a id="Bifurcations-of-periodic-orbits-1"></a><a class="docs-heading-anchor-permalink" href="#Bifurcations-of-periodic-orbits" title="Permalink"></a></h2><p>The detection is triggered by setting <code>detectBifurcation &gt; 1</code> in the parameter <code>::ContinuationPar</code> passed to <code>continuation</code>. The detection of bifurcation points is done by analysis of the spectrum of the Monodromy matrix composed of the Floquet multipliers. The following bifurcations are currently detected:</p><ul><li>Fold of periodic orbit</li><li>Neimark-Sacker </li><li>Period doubling</li></ul><div class="admonition is-danger"><header class="admonition-header">Floquet multipliers computation</header><div class="admonition-body"><p>The computation of Floquet multipliers is necessary for the detection of bifurcations of periodic orbits (which is done by analyzing the Floquet exponents obtained from the Floquet multipliers). Hence, the eigensolver needs to compute the eigenvalues with largest modulus (and not with largest real part which is their default behavior). This can be done by changing the option <code>which = :LM</code> of the eigensolver. Nevertheless, note that for most implemented eigensolvers in the current Package, the proper option is set.   </p></div></div><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>In this case, the Krylov dimension is not increased because the eigensolver could be a direct solver. You might want to increase this dimension using the callbacks in <a href="../library/#BifurcationKit.continuation"><code>continuation</code></a>. </li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../EventCallback/">« Event Handling and Callback</a><a class="docs-footer-nextpage" href="../codim2Continuation/">Fold / Hopf Continuation (codim 2) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Saturday 8 January 2022 09:06">Saturday 8 January 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
