<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction Â· Bifurcation Analysis in Julia</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Bifurcation Analysis in Julia logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Bifurcation Analysis in Julia</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../capabilities/">Overview of capabilities</a></li><li><a class="tocitem" href="../gettingstarted/">Getting Started with BifurcationKit</a></li><li><a class="tocitem" href="../tutorials/tutorials/">Tutorials</a></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Basics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../guidelines/">Guidelines</a></li><li><a class="tocitem" href="../educational/">Educational introduction</a></li><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../plotting/">Plot functions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">Problems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../BifProblem/">Bifurcation Problem</a></li><li><a class="tocitem" href="../diffeq/">DiffEq wrapper</a></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox" checked/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Periodic Orbits</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Introduction</a><ul class="internal"><li><a class="tocitem" href="#Important-notes"><span>Important notes</span></a></li></ul></li><li><a class="tocitem" href="../periodicOrbitTrapeze/">Trapezoid</a></li><li><a class="tocitem" href="../periodicOrbitCollocation/">Collocation</a></li><li><a class="tocitem" href="../periodicOrbitShooting/">Shooting</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Symmetries / Waves</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../intro_wave/">Introduction</a></li><li><a class="tocitem" href="../waveEigen/">Eigen Solvers</a></li><li><a class="tocitem" href="../ModulatedTW/">Modulated Travelling waves</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Continuation methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../IntroContinuation/">Introduction</a></li><li><a class="tocitem" href="../Predictors/">Predictors / correctors</a></li><li><a class="tocitem" href="../PALC/">PALC</a></li><li><a class="tocitem" href="../MooreSpence/">Moore-Penrose continuation</a></li><li><a class="tocitem" href="../ANM/">ANM</a></li><li><a class="tocitem" href="../DeflatedContinuation/">Deflated continuation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Functionalities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-1" type="checkbox"/><label class="tocitem" for="menuitem-8-1"><span class="docs-label">Nonlinear equations (Newton)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../newton/">Krylov-Newton algorithm</a></li><li><a class="tocitem" href="../deflatedproblem/">Deflated problems</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-2" type="checkbox"/><label class="tocitem" for="menuitem-8-2"><span class="docs-label">Bifurcations (equilibria)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../detectionBifurcation/">Bifurcation detection (1 param)</a></li><li><a class="tocitem" href="../codim2Continuation/">Fold / Hopf Continuation (2 params)</a></li><li><a class="tocitem" href="../codim3Continuation/">Bogdanov-Takens refinement (3 params)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-3" type="checkbox"/><label class="tocitem" for="menuitem-8-3"><span class="docs-label">Bifurcations (periodic orbits)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../detectionBifurcationPO/">Bifurcation detection (1 param)</a></li><li><a class="tocitem" href="../FoldContinuationPO/">Fold continuation (2 params)</a></li><li><a class="tocitem" href="../PDContinuationPO/">Period-Doubling continuation (2 params)</a></li><li><a class="tocitem" href="../NSContinuationPO/">Neimark-Sacker continuation (2 params)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-4" type="checkbox"/><label class="tocitem" for="menuitem-8-4"><span class="docs-label">Normal form (equilibria)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../simplebp/">Simple branch point</a></li><li><a class="tocitem" href="../nonsimplebp/">Non-simple branch point</a></li><li><a class="tocitem" href="../simplehopf/">Simple Hopf</a></li><li><a class="tocitem" href="../cusp/">Cusp</a></li><li><a class="tocitem" href="../bt/">Bogdanov-Takens</a></li><li><a class="tocitem" href="../bautin/">Bautin</a></li><li><a class="tocitem" href="../zh/">Zero-Hopf</a></li><li><a class="tocitem" href="../hh/">Hopf-Hopf</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-5" type="checkbox"/><label class="tocitem" for="menuitem-8-5"><span class="docs-label">Normal form (periodic orbits)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../pd/">Period-doubling</a></li><li><a class="tocitem" href="../ns/">Neimarck-Sacker</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-6" type="checkbox"/><label class="tocitem" for="menuitem-8-6"><span class="docs-label">Branch switching</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../intro-abs/">Introduction</a></li><li><a class="tocitem" href="../abs-from-eq/">From equilibria to equilibria</a></li><li><a class="tocitem" href="../abs-from-hopf/">From Hopf/PD/Branch to periodic orbits</a></li><li><a class="tocitem" href="../abs-from-codim2-eq/">From codim 2 to equilibria</a></li><li><a class="tocitem" href="../abs-from-codim2-po/">From codim 2 to periodic orbits</a></li></ul></li><li><a class="tocitem" href="../BifurcationDiagram/">Bifurcation diagram</a></li><li><a class="tocitem" href="../EventCallback/">Event handling and Callback</a></li><li><a class="tocitem" href="../iterator/">Iterator Interface</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Options</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../linearsolver/">Linear solvers</a></li><li><a class="tocitem" href="../borderedlinearsolver/">Bordered linear solvers</a></li><li><a class="tocitem" href="../eigensolver/">Eigen solvers</a></li><li><a class="tocitem" href="../Borderedarrays/">Bordered arrays</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Contributing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-10-1" type="checkbox"/><label class="tocitem" for="menuitem-10-1"><span class="docs-label">Interfaces</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../interfaceLS/">Vector</a></li><li><a class="tocitem" href="../interfaceLS/">Linear / eigen Solvers</a></li><li><a class="tocitem" href="../interfacePred/">Predictor / corrector</a></li><li><a class="tocitem" href="../interfaceFlow/">Flow</a></li></ul></li></ul></li><li><a class="tocitem" href="../faq/">Frequently asked questions</a></li><li><a class="tocitem" href="../migration/">Migration from old versions</a></li><li><a class="tocitem" href="../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Problems</a></li><li><a class="is-disabled">Periodic Orbits</a></li><li class="is-active"><a href>Introduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introduction</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/bifurcationkit/BifurcationKitDocs.jl/blob/main/docs/src/periodicOrbit.md" title="Edit on GitHub"><span class="docs-icon fab">ï</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Periodic-orbits-computation"><a class="docs-heading-anchor" href="#Periodic-orbits-computation">Periodic orbits computation</a><a id="Periodic-orbits-computation-1"></a><a class="docs-heading-anchor-permalink" href="#Periodic-orbits-computation" title="Permalink"></a></h1><p>Consider the Cauchy problem</p><p class="math-container">\[\frac{du}{dt}=F(u,p).\]</p><p>A periodic solution with period <span>$T$</span> satisfies</p><p class="math-container">\[\begin{align}
\frac{du}{dt}&amp;=F(u,p)\\
u(0)&amp;=u(T).
\end{align}\]</p><p>We provide 4 methods for computing periodic orbits (PO):</p><ol><li>one (Trapezoid) based on finite differences to discretize a Cauchy problem,</li><li>one (Collocation) based on orthogonal collocation to discretize a Cauchy problem,</li><li>two (Shooting) based on the flow associated to a Cauchy problem.</li></ol><p>It is important to understand the pro and cons of each method to compute PO in large dimensions.</p><h3 id="Trapezoid-method"><a class="docs-heading-anchor" href="#Trapezoid-method">Trapezoid method</a><a id="Trapezoid-method-1"></a><a class="docs-heading-anchor-permalink" href="#Trapezoid-method" title="Permalink"></a></h3><p>The Trapezoid method (or the Collocation one) is usually faster than the ones based on Shooting but it requires more memory as it saves the whole orbit. However the main drawback of this method is that the associated linear solver is not &quot;nice&quot;, being composed of a cyclic matrix for which no generic Matrix-free preconditioner is known. Hence, the Trapezoid method is <strong>often used with an ILU preconditioner</strong> which is severely constrained by memory. Also, when the period of the cycle is large, finer time discretization (or mesh adaptation which is not yet implemented) must be employed which is also a limiting factor both in term of memory and preconditioning.</p><h3 id="Collocation-method"><a class="docs-heading-anchor" href="#Collocation-method">Collocation method</a><a id="Collocation-method-1"></a><a class="docs-heading-anchor-permalink" href="#Collocation-method" title="Permalink"></a></h3><p>The Collocation method is (for now) the slowest of the three methods implemented for computing periodic orbits. However, it is by far the most precise one. Additionally, the mesh can be automatically adapted during the continuation. The implementation will be improved for large dimensional systems like the Trapezoid method one.</p><h3 id="Shooting-method"><a class="docs-heading-anchor" href="#Shooting-method">Shooting method</a><a id="Shooting-method-1"></a><a class="docs-heading-anchor-permalink" href="#Shooting-method" title="Permalink"></a></h3><p>The methods based on Shooting do not share the same drawbacks because the associated linear system is usually well conditioned, at least in the simple shooting case. There are thus often used <strong>without preconditioner at all</strong>. Even in the case of multiple shooting, this can be alleviated by a simple generic preconditioner based on deflation of eigenvalues (see <a href="../linearsolver/#Linear-solvers-(LS)">Linear solvers (LS)</a>). Also, the time stepper will automatically adapt to the stiffness of the problem, putting more time points where needed unlike the method based on finite differences which requires an adaptive (time) meshing to provide a similar property. Finally, we can use parallel Shooting to greatly increase the speed of computation.</p><p>The main drawback of the method is to find a fast time stepper, at least to compete with the method based on finite differences. The other drawback is the precision of the method which cannot compete with the collocation method.</p><h2 id="Important-notes"><a class="docs-heading-anchor" href="#Important-notes">Important notes</a><a id="Important-notes-1"></a><a class="docs-heading-anchor-permalink" href="#Important-notes" title="Permalink"></a></h2><p>We regroup here some important notes which are valid for all methods above. </p><h3 id=".-Accessing-the-periodic-orbit"><a class="docs-heading-anchor" href="#.-Accessing-the-periodic-orbit">1. Accessing the periodic orbit</a><a id=".-Accessing-the-periodic-orbit-1"></a><a class="docs-heading-anchor-permalink" href="#.-Accessing-the-periodic-orbit" title="Permalink"></a></h3><p>In <code>record_from_solution</code>, <code>plot_solution</code> or after the computation of a branch of periodic orbits, how do I obtain the periodic orbit, for plotting purposes for example? If <code>x</code> is the solution from <code>newton</code> for the parameter <code>p</code>, you can obtain the periodic orbit as follows</p><pre><code class="nohighlight hljs">xtt = get_periodic_orbit(x, p)</code></pre><p>where <code>xtt.t</code> contains the time mesh and <code>xtt[:,:]</code> contains the different components. Note that for Trapezoid and collocation methods, calling <code>get_periodic_orbit</code> is essentially free as it is a reshape of <code>x</code>. However, in the case of Shooting methods, this requires recomputing the periodic orbit which can be costly for large scale problems.</p><h3 id=".-Finaliser"><a class="docs-heading-anchor" href="#.-Finaliser">2. Finaliser</a><a id=".-Finaliser-1"></a><a class="docs-heading-anchor-permalink" href="#.-Finaliser" title="Permalink"></a></h3><p>If you pass a <code>finalise_solution</code> function to <a href="../library/#BifurcationKit.continuation"><code>continuation</code></a>, the following occurs:</p><ol><li>If the newton solve was successful, we update the phase condition every <code>update_section_every_step</code></li><li>we call the user defined finalizer <code>finalise_solution</code></li></ol><h3 id=".-Record-from-solution"><a class="docs-heading-anchor" href="#.-Record-from-solution">3. Record from solution</a><a id=".-Record-from-solution-1"></a><a class="docs-heading-anchor-permalink" href="#.-Record-from-solution" title="Permalink"></a></h3><p>You can pass your own function to <a href="../library/#BifurcationKit.continuation"><code>continuation</code></a>. In the particular case of periodic orbits, the method is called like <code>record_from_solution(x, opt; k...)</code> where <code>opt.p</code> is the current value of the continuation parameter and <code>opt.prob</code> is the current state of the continuation problem. You can then obtain the current periodic orbit using (see above)</p><pre><code class="language-julia hljs">xtt = get_periodic_orbit(x, opt.p)</code></pre><h3 id=".-Plot-solution"><a class="docs-heading-anchor" href="#.-Plot-solution">4. Plot solution</a><a id=".-Plot-solution-1"></a><a class="docs-heading-anchor-permalink" href="#.-Plot-solution" title="Permalink"></a></h3><p>Similarly to <code>record_from_solution</code>, the method is called like <code>plot_solution(x, opt; k...)</code> where <code>opt.p</code> is the current value of the continuation parameter and <code>opt.prob</code> is the current state of the continuation problem.</p><h3 id=".-Most-precise-method-for-Floquet-coefficients"><a class="docs-heading-anchor" href="#.-Most-precise-method-for-Floquet-coefficients">5. Most precise method for Floquet coefficients</a><a id=".-Most-precise-method-for-Floquet-coefficients-1"></a><a class="docs-heading-anchor-permalink" href="#.-Most-precise-method-for-Floquet-coefficients" title="Permalink"></a></h3><p>The state of the art method is based on a Periodic Schur decomposition. It is available through the package <a href="https://github.com/bifurcationkit/PeriodicSchurBifurcationKit.jl">PeriodicSchurBifurcationKit.jl</a>. For more information, have a look at <code>FloquetPQZ</code>.</p><h3 id=".-Misc"><a class="docs-heading-anchor" href="#.-Misc">6. Misc</a><a id=".-Misc-1"></a><a class="docs-heading-anchor-permalink" href="#.-Misc" title="Permalink"></a></h3><p><code>set_params_po</code> <code>generate_ci_problem</code> <code>generate_solution</code></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../diffeq/">Â« DiffEq wrapper</a><a class="docs-footer-nextpage" href="../periodicOrbitTrapeze/">Trapezoid Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Saturday 27 January 2024 14:28">Saturday 27 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
