<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Moore-Penrose continuation · Bifurcation Analysis in Julia</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Bifurcation Analysis in Julia logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Bifurcation Analysis in Julia</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../capabilities/">Overview of capabilities</a></li><li><a class="tocitem" href="../gettingstarted/">Getting Started with BifurcationKit</a></li><li><a class="tocitem" href="../tutorials/tutorials/">Tutorials</a></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Basics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../guidelines/">Guidelines</a></li><li><a class="tocitem" href="../educational/">Educational introduction</a></li><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../plotting/">Plot functions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Problems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../BifProblem/">Bifurcation Problem</a></li><li><a class="tocitem" href="../diffeq/">DiffEq wrapper</a></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Periodic Orbits</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../periodicOrbit/">Introduction</a></li><li><a class="tocitem" href="../periodicOrbitTrapeze/">Trapezoid</a></li><li><a class="tocitem" href="../periodicOrbitCollocation/">Collocation</a></li><li><a class="tocitem" href="../periodicOrbitShooting/">Shooting</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Symmetries / Waves</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../intro_wave/">Introduction</a></li><li><a class="tocitem" href="../waveEigen/">Eigen Solvers</a></li><li><a class="tocitem" href="../ModulatedTW/">Modulated Travelling waves</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox" checked/><label class="tocitem" for="menuitem-7"><span class="docs-label">Continuation methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../IntroContinuation/">Introduction</a></li><li><a class="tocitem" href="../Predictors/">Predictors / correctors</a></li><li><a class="tocitem" href="../PALC/">PALC</a></li><li class="is-active"><a class="tocitem" href>Moore-Penrose continuation</a><ul class="internal"><li><a class="tocitem" href="#Predictor"><span>Predictor</span></a></li><li><a class="tocitem" href="#Corrector"><span>Corrector</span></a></li><li><a class="tocitem" href="#Linear-Algebra"><span>Linear Algebra</span></a></li><li><a class="tocitem" href="#Algorithm-for-solving-(MS)"><span>Algorithm for solving (MS)</span></a></li><li><a class="tocitem" href="#Step-size-control"><span>Step size control</span></a></li></ul></li><li><a class="tocitem" href="../ANM/">ANM</a></li><li><a class="tocitem" href="../DeflatedContinuation/">Deflated continuation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Functionalities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-1" type="checkbox"/><label class="tocitem" for="menuitem-8-1"><span class="docs-label">Nonlinear equations (Newton)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../newton/">Krylov-Newton algorithm</a></li><li><a class="tocitem" href="../deflatedproblem/">Deflated problems</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-2" type="checkbox"/><label class="tocitem" for="menuitem-8-2"><span class="docs-label">Bifurcations (equilibria)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../detectionBifurcation/">Bifurcation detection (1 param)</a></li><li><a class="tocitem" href="../codim2Continuation/">Fold / Hopf Continuation (2 params)</a></li><li><a class="tocitem" href="../codim3Continuation/">Bogdanov-Takens refinement (3 params)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-3" type="checkbox"/><label class="tocitem" for="menuitem-8-3"><span class="docs-label">Bifurcations (periodic orbits)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../detectionBifurcationPO/">Bifurcation detection (1 param)</a></li><li><a class="tocitem" href="../FoldContinuationPO/">Fold continuation (2 params)</a></li><li><a class="tocitem" href="../PDContinuationPO/">Period-Doubling continuation (2 params)</a></li><li><a class="tocitem" href="../NSContinuationPO/">Neimark-Sacker continuation (2 params)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-4" type="checkbox"/><label class="tocitem" for="menuitem-8-4"><span class="docs-label">Normal form (equilibria)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../simplebp/">Simple branch point</a></li><li><a class="tocitem" href="../nonsimplebp/">Non-simple branch point</a></li><li><a class="tocitem" href="../simplehopf/">Simple Hopf</a></li><li><a class="tocitem" href="../cusp/">Cusp</a></li><li><a class="tocitem" href="../bt/">Bogdanov-Takens</a></li><li><a class="tocitem" href="../bautin/">Bautin</a></li><li><a class="tocitem" href="../zh/">Zero-Hopf</a></li><li><a class="tocitem" href="../hh/">Hopf-Hopf</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-5" type="checkbox"/><label class="tocitem" for="menuitem-8-5"><span class="docs-label">Normal form (periodic orbits)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../pd/">Period-doubling</a></li><li><a class="tocitem" href="../ns/">Neimarck-Sacker</a></li></ul></li><li><a class="tocitem" href="../branchswitching/">Branch switching</a></li><li><a class="tocitem" href="../BifurcationDiagram/">Bifurcation diagram</a></li><li><a class="tocitem" href="../EventCallback/">Event handling and Callback</a></li><li><a class="tocitem" href="../iterator/">Iterator Interface</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Options</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../linearsolver/">Linear solvers</a></li><li><a class="tocitem" href="../borderedlinearsolver/">Bordered linear solvers</a></li><li><a class="tocitem" href="../eigensolver/">Eigen solvers</a></li><li><a class="tocitem" href="../Borderedarrays/">Bordered arrays</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Contributing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-10-1" type="checkbox"/><label class="tocitem" for="menuitem-10-1"><span class="docs-label">Interfaces</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../interfaceLS/">Vector</a></li><li><a class="tocitem" href="../interfaceLS/">Linear / eigen Solvers</a></li><li><a class="tocitem" href="../interfacePred/">Predictor / corrector</a></li><li><a class="tocitem" href="../interfaceFlow/">Flow</a></li></ul></li></ul></li><li><a class="tocitem" href="../faq/">Frequently asked questions</a></li><li><a class="tocitem" href="../migration/">Migration to v0.2.x</a></li><li><a class="tocitem" href="../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Continuation methods</a></li><li class="is-active"><a href>Moore-Penrose continuation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Moore-Penrose continuation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/bifurcationkit/BifurcationKitDocs.jl/blob/main/docs/src/MooreSpence.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Moore-Penrose-continuation"><a class="docs-heading-anchor" href="#Moore-Penrose-continuation">Moore-Penrose continuation</a><a id="Moore-Penrose-continuation-1"></a><a class="docs-heading-anchor-permalink" href="#Moore-Penrose-continuation" title="Permalink"></a></h1><div class="admonition is-warning"><header class="admonition-header">WIP</header><div class="admonition-body"><p>This is work in progress. The interface will be improved inn the future.</p></div></div><p>This is one of the various continuation methods implemented in <code>BifurcationKit.jl</code>. It is set by the option <code>alg = MoorePenrose()</code> in <a href="../library/#BifurcationKit.continuation"><code>continuation</code></a>. See also <a href="../library/#BifurcationKit.MoorePenrose"><code>MoorePenrose</code></a> for more information.</p><p>For solving</p><p class="math-container">\[\mathbb R^n\ni F(x,p) = 0 \quad\tag{E}\]</p><p>using a Newton algorithm, we miss an equation. Hence, we proceed as follows <sup class="footnote-reference"><a id="citeref-Meijer" href="#footnote-Meijer">[Meijer]</a></sup>. Starting from a predictor <span>$(x_1,p_1)$</span>, we look for the solution to (E) that is closest to <span>$(x_1,p_1)$</span>. Hence, we optimise</p><p class="math-container">\[\min_{(x,p)} \{ \|(x,p)-(x_1,p_1)\| \text{ such that } F(x,p)=0\} \tag{MS}\]</p><p>It can be interpreted as a PALC in which the hyperplane is adapted at every step.  </p><h2 id="Predictor"><a class="docs-heading-anchor" href="#Predictor">Predictor</a><a id="Predictor-1"></a><a class="docs-heading-anchor-permalink" href="#Predictor" title="Permalink"></a></h2><p>The possible predictors <code>tangent::AbstractTangentPredictor</code> are listed in <a href="../Predictors/#Predictors-Correctors">Predictors - Correctors</a>. They can be used to create a Moore-Penrose algorithm  like <code>MoorePenrose(tangent = PALC())</code></p><h2 id="Corrector"><a class="docs-heading-anchor" href="#Corrector">Corrector</a><a id="Corrector-1"></a><a class="docs-heading-anchor-permalink" href="#Corrector" title="Permalink"></a></h2><p>The corrector is the Gauss Newton algorithm applied to (MS).</p><h2 id="Linear-Algebra"><a class="docs-heading-anchor" href="#Linear-Algebra">Linear Algebra</a><a id="Linear-Algebra-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-Algebra" title="Permalink"></a></h2><p>Let us discuss more about the norm and dot product. First, the option <code>normC</code> <a href="../library/#BifurcationKit.continuation"><code>continuation</code></a> specifies the norm used to evaluate the distance in (MS). The dot product (resp. norm) used in the (iterative) linear solvers is <code>LinearAlgebra.dot</code> (resp. <code>LinearAlgebra.norm</code>). It can be changed by importing these functions and redefining it. Note that by default, the <span>$L^2$</span> norm is used.</p><p>The linear solver for the linear problem associated to (MS) is set by the option <code>linearAlgo</code> in <a href="../library/#BifurcationKit.continuation"><code>continuation</code></a>: it is one of <a href="../borderedlinearsolver/#Bordered-linear-solvers-(BLS)">Bordered linear solvers (BLS)</a>.</p><h2 id="Algorithm-for-solving-(MS)"><a class="docs-heading-anchor" href="#Algorithm-for-solving-(MS)">Algorithm for solving (MS)</a><a id="Algorithm-for-solving-(MS)-1"></a><a class="docs-heading-anchor-permalink" href="#Algorithm-for-solving-(MS)" title="Permalink"></a></h2><p>Let us write <span>$y\equiv(x,p)\in\mathbb R^{N+1}$</span>. In order to solve for the argmin, we apply the newton algorithm with jacobian belonging to <span>$\mathbb R^{N\times (N+1)}$</span>:</p><p class="math-container">\[y^{k+1} = y^k -d_yF(y^k)^+F(y^k)\]</p><p>where the superscript <span>$^+$</span> indicates the Moore-Penrose pseudoinverse of rank <span>$N$</span>.</p><h3 id="Direct-case"><a class="docs-heading-anchor" href="#Direct-case">Direct case</a><a id="Direct-case-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-case" title="Permalink"></a></h3><p>In this case, triggered by the option <code>MoorePenrose(method = BifurcationKit.direct)</code>, the pseudoinverse is computed with <code>\</code>.</p><p>the option <code>MoorePenrose(method = BifurcationKit.pInv)</code>, the pseudoinverse is computed with <code>pinv</code>.</p><h3 id="Iterative-case"><a class="docs-heading-anchor" href="#Iterative-case">Iterative case</a><a id="Iterative-case-1"></a><a class="docs-heading-anchor-permalink" href="#Iterative-case" title="Permalink"></a></h3><p>In this case, triggered by the option <code>MoorePenrose(method = BifurcationKit.iterative)</code>, the pseudoinverse is computed with an iterative method described in <sup class="footnote-reference"><a id="citeref-Meijer" href="#footnote-Meijer">[Meijer]</a></sup>:</p><p class="math-container">\[\left\{\begin{array}{l}
y_{1}^{j+1}=y_{1}^{j}-\left(\begin{array}{c}
F_{y}\left(y_{1}^{j}\right) \\
\left(\phi_{1}^{j}\right)^{\top}
\end{array}\right)^{-1}\left(\begin{array}{c}
F\left(y_{1}^{j}\right) \\
0
\end{array}\right) \\
\phi_{1}^{j+1}=\left(\begin{array}{c}
F_{y}\left(y_{1}^{j+1}\right) \\
\left(\phi_{1}^{j}\right)^{\top}
\end{array}\right)^{-1}\left(\begin{array}{l}
0 \\
1
\end{array}\right), \quad j=0,1,2, \ldots
\end{array}\right.\]</p><p>We initialise <span>$\phi_1^0$</span> with the tangent.</p><h2 id="Step-size-control"><a class="docs-heading-anchor" href="#Step-size-control">Step size control</a><a id="Step-size-control-1"></a><a class="docs-heading-anchor-permalink" href="#Step-size-control" title="Permalink"></a></h2><p>Each time the corrector fails, the step size <span>$ds$</span> is halved. This has the disadvantage of having lost Newton iterations (which costs time) and imposing small steps (which can be slow as well). To prevent this, the step size is controlled internally with the idea of having a constant number of Newton iterations per point. This is in part controlled by the aggressiveness factor <code>a</code> in <code>ContinuationPar</code>.</p><h3 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h3><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Meijer"><a class="tag is-link" href="#citeref-Meijer">Meijer</a><blockquote><p>Meijer, Dercole, and Oldeman, “Numerical Bifurcation Analysis.”</p></blockquote></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../PALC/">« PALC</a><a class="docs-footer-nextpage" href="../ANM/">ANM »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 11 December 2023 08:33">Monday 11 December 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
