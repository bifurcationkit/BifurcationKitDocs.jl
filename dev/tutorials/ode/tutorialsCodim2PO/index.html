<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>üü† Periodic predator-prey model ¬∑ Bifurcation Analysis in Julia</title><meta name="title" content="üü† Periodic predator-prey model ¬∑ Bifurcation Analysis in Julia"/><meta property="og:title" content="üü† Periodic predator-prey model ¬∑ Bifurcation Analysis in Julia"/><meta property="twitter:title" content="üü† Periodic predator-prey model ¬∑ Bifurcation Analysis in Julia"/><meta name="description" content="Documentation for Bifurcation Analysis in Julia."/><meta property="og:description" content="Documentation for Bifurcation Analysis in Julia."/><meta property="twitter:description" content="Documentation for Bifurcation Analysis in Julia."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.svg" alt="Bifurcation Analysis in Julia logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Bifurcation Analysis in Julia</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../capabilities/">Overview of capabilities</a></li><li><a class="tocitem" href="../../../gettingstarted/">Getting Started with BifurcationKit</a></li><li><a class="tocitem" href="../../tutorials/">Tutorials</a></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Basics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../guidelines/">Guidelines</a></li><li><a class="tocitem" href="../../../educational/">Educational introduction</a></li><li><a class="tocitem" href="../../../overview/">Overview</a></li><li><a class="tocitem" href="../../../plotting/">Plot functions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Problems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../BifProblem/">Bifurcation Problem</a></li><li><a class="tocitem" href="../../../diffeq/">DiffEq wrapper</a></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Periodic Orbits</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../periodicOrbit/">Introduction</a></li><li><a class="tocitem" href="../../../periodicOrbitTrapeze/">Trapezoid</a></li><li><a class="tocitem" href="../../../periodicOrbitCollocation/">Collocation</a></li><li><a class="tocitem" href="../../../periodicOrbitShooting/">Shooting</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Symmetries / Waves</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../intro_wave/">Introduction</a></li><li><a class="tocitem" href="../../../waveEigen/">Eigen Solvers</a></li><li><a class="tocitem" href="../../../ModulatedTW/">Modulated Travelling waves</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Continuation methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../IntroContinuation/">Introduction</a></li><li><a class="tocitem" href="../../../Predictors/">Predictors / correctors</a></li><li><a class="tocitem" href="../../../PALC/">PALC</a></li><li><a class="tocitem" href="../../../MooreSpence/">Moore-Penrose continuation</a></li><li><a class="tocitem" href="../../../hybrid/">AutoSwitch</a></li><li><a class="tocitem" href="../../../ANM/">ANM</a></li><li><a class="tocitem" href="../../../DeflatedContinuation/">Deflated continuation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Functionalities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-1" type="checkbox"/><label class="tocitem" for="menuitem-8-1"><span class="docs-label">Nonlinear equations (Newton)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../newton/">Krylov-Newton algorithm</a></li><li><a class="tocitem" href="../../../deflatedproblem/">Deflated problems</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-2" type="checkbox"/><label class="tocitem" for="menuitem-8-2"><span class="docs-label">Bifurcations (equilibria)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../detectionBifurcation/">Bifurcation detection (1 param)</a></li><li><a class="tocitem" href="../../../codim2Continuation/">Fold / Hopf Continuation (2 params)</a></li><li><a class="tocitem" href="../../../codim3Continuation/">Bogdanov-Takens refinement (3 params)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-3" type="checkbox"/><label class="tocitem" for="menuitem-8-3"><span class="docs-label">Bifurcations (periodic orbits)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../detectionBifurcationPO/">Bifurcation detection (1 param)</a></li><li><a class="tocitem" href="../../../FoldContinuationPO/">Fold continuation (2 params)</a></li><li><a class="tocitem" href="../../../PDContinuationPO/">Period-Doubling continuation (2 params)</a></li><li><a class="tocitem" href="../../../NSContinuationPO/">Neimark-Sacker continuation (2 params)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-4" type="checkbox"/><label class="tocitem" for="menuitem-8-4"><span class="docs-label">Normal form (equilibria)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../simplebp/">Simple branch point</a></li><li><a class="tocitem" href="../../../nonsimplebp/">Non-simple branch point</a></li><li><a class="tocitem" href="../../../simplehopf/">Simple Hopf</a></li><li><a class="tocitem" href="../../../cusp/">Cusp</a></li><li><a class="tocitem" href="../../../bt/">Bogdanov-Takens</a></li><li><a class="tocitem" href="../../../bautin/">Bautin</a></li><li><a class="tocitem" href="../../../zh/">Zero-Hopf</a></li><li><a class="tocitem" href="../../../hh/">Hopf-Hopf</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-5" type="checkbox"/><label class="tocitem" for="menuitem-8-5"><span class="docs-label">Normal form (periodic orbits)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../bppo/">Simple branch point</a></li><li><a class="tocitem" href="../../../pd/">Period-doubling</a></li><li><a class="tocitem" href="../../../ns/">Neimark-Sacker</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-6" type="checkbox"/><label class="tocitem" for="menuitem-8-6"><span class="docs-label">Branch switching</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../intro-abs/">Introduction</a></li><li><a class="tocitem" href="../../../abs-from-eq/">From equilibria to equilibria</a></li><li><a class="tocitem" href="../../../abs-from-hopf/">From Hopf/PD/Branch to periodic orbits</a></li><li><a class="tocitem" href="../../../abs-from-codim2-eq/">From codim 2 to equilibria</a></li><li><a class="tocitem" href="../../../abs-from-codim2-po/">From codim 2 to periodic orbits</a></li></ul></li><li><a class="tocitem" href="../../../BifurcationDiagram/">Bifurcation diagram</a></li><li><a class="tocitem" href="../../../EventCallback/">Event handling and Callback</a></li><li><a class="tocitem" href="../../../iterator/">Iterator Interface</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Options</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../linearsolver/">Linear solvers</a></li><li><a class="tocitem" href="../../../borderedlinearsolver/">Bordered linear solvers</a></li><li><a class="tocitem" href="../../../eigensolver/">Eigen solvers</a></li><li><a class="tocitem" href="../../../Borderedarrays/">Bordered arrays</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Contributing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-10-1" type="checkbox"/><label class="tocitem" for="menuitem-10-1"><span class="docs-label">Interfaces</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../interfaceLS/">Vector</a></li><li><a class="tocitem" href="../../../interfaceLS/">Linear / eigen Solvers</a></li><li><a class="tocitem" href="../../../interfacePred/">Predictor / corrector</a></li><li><a class="tocitem" href="../../../interfaceFlow/">Flow</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../faq/">Frequently asked questions</a></li><li><a class="tocitem" href="../../../migration/">Migration from old versions</a></li><li><a class="tocitem" href="../../../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>üü† Periodic predator-prey model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>üü† Periodic predator-prey model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/bifurcationkit/BifurcationKitDocs.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/bifurcationkit/BifurcationKitDocs.jl/blob/main/docs/src/tutorials/ode/tutorialsCodim2PO.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Periodic-predator-prey-model"><a class="docs-heading-anchor" href="#Periodic-predator-prey-model">üü† Periodic predator-prey model</a><a id="Periodic-predator-prey-model-1"></a><a class="docs-heading-anchor-permalink" href="#Periodic-predator-prey-model" title="Permalink"></a></h1><ul><li><a href="#Periodic-predator-prey-model">üü† Periodic predator-prey model</a></li><li class="no-marker"><ul><li><a href="#Simulation-of-the-model">Simulation of the model</a></li><li><a href="#Utility-functions">Utility functions</a></li><li><a href="#Periodic-orbits-with-trapezoid-method">Periodic orbits with trapezoid method</a></li><li><a href="#Periodic-orbits-with-parallel-standard-shooting">Periodic orbits with parallel standard shooting</a></li><li><a href="#Periodic-orbits-with-orthogonal-collocation">Periodic orbits with orthogonal collocation</a></li><li><a href="#Continuation-of-Fold-/-PD-of-periodic-orbits-with-Collocation">Continuation of Fold / PD of periodic orbits with Collocation</a></li><li><a href="#References">References</a></li></ul></li></ul><blockquote><p>This example is found in the MatCont ecosystem.</p></blockquote><p>The following is a periodically forced predator-prey model studied in <sup class="footnote-reference"><a id="citeref-Kuznetsov" href="#footnote-Kuznetsov">[Kuznetsov]</a></sup> using shooting techniques.</p><p class="math-container">\[\tag{E}\left\{\begin{aligned}
\dot{x} &amp; =r\left(1-\frac{x}{K}\right) x-\frac{a x y}{b_0(1+\varepsilon u)+x} \\
\dot{y} &amp; =e \frac{a x y}{b_0(1+\varepsilon u)+x}-d y \\
\dot{u} &amp; =u-2 \pi v-\left(u^2+v^2\right) u \\
\dot{v} &amp; =2 \pi u+v-\left(u^2+v^2\right) v
\end{aligned}\right.\]</p><p>This tutorial is useful in that we show how to start periodic orbits continuation from solutions obtained from solving ODEs. We are interested in cases where <span>$(u,v)\neq (0,0)$</span> for which we have only periodic solutions. Thus, we cannot rely on branching from equilibria to find these periodic orbits.</p><pre><code class="language-julia hljs">using Revise, Plots
using BifurcationKit
const BK = BifurcationKit

function Pop!(du, X, p, t = 0)
	(;r,K,a,œµ,b0,e,d) = p
	x, y, u, v = X
	p = a * x / (b0 * (1 + œµ * u) + x)
	du[1] = r * (1 - x/K) * x - p * y
	du[2] = e * p * y - d * y
	s = u^2 + v^2
	du[3] = u-2pi * v - s * u
	du[4] = 2pi * u + v - s * v
	du
end

par_pop = ( K = 1., r = 6.28, a = 12.56, b0 = 0.25, e = 1., d = 6.28, œµ = 0.2, )

z0 = [0.1,0.1,1,0]

prob = BifurcationProblem(Pop!, z0, par_pop, (@optic _.b0);
	record_from_solution = (x, p; k...) -&gt; (x = x[1], y = x[2], u = x[3]))

opts_br = ContinuationPar(p_min = 0., p_max = 20.0, ds = 0.002, dsmax = 0.01, n_inversion = 6, nev = 4)</code></pre><h2 id="Simulation-of-the-model"><a class="docs-heading-anchor" href="#Simulation-of-the-model">Simulation of the model</a><a id="Simulation-of-the-model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-of-the-model" title="Permalink"></a></h2><p>This is very straightforward thanks to <code>SciML</code>.</p><pre><code class="language-julia hljs">using DifferentialEquations
prob_de = ODEProblem(Pop!, z0, (0,200.), par_pop)
sol = DifferentialEquations.solve(prob_de, Rodas5())
prob_de = ODEProblem(Pop!, sol.u[end], (0,3.), par_pop, reltol = 1e-8, abstol = 1e-10)
sol = DifferentialEquations.solve(prob_de, Rodas5())
plot(sol)</code></pre><img src="f3d1f03e.svg" alt="Example block output"/><h2 id="Utility-functions"><a class="docs-heading-anchor" href="#Utility-functions">Utility functions</a><a id="Utility-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Utility-functions" title="Permalink"></a></h2><p>We start with two helper functions that record and plot the periodic orbits. The following works for shooting, collocation and trapezoid methods for computing periodic orbits.</p><pre><code class="language-julia hljs">argspo = (record_from_solution = (x, p; k...) -&gt; begin
		xtt = get_periodic_orbit(p.prob, x, p.p)
		return (max = maximum(xtt[1,:]),
				min = minimum(xtt[1,:]),
				period = getperiod(p.prob, x, p.p))
	end,
	plot_solution = (x, p; k...) -&gt; begin
		xtt = get_periodic_orbit(p.prob, x, p.p)
		plot!(xtt.t, xtt[1,:]; label = &quot;x&quot;, k...)
		plot!(xtt.t, xtt[2,:]; label = &quot;y&quot;, k...)
		# plot!(br; subplot = 1, putspecialptlegend = false)
	end)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(record_from_solution = Main.var&quot;#4#8&quot;(), plot_solution = Main.var&quot;#6#9&quot;())</code></pre><h2 id="Periodic-orbits-with-trapezoid-method"><a class="docs-heading-anchor" href="#Periodic-orbits-with-trapezoid-method">Periodic orbits with trapezoid method</a><a id="Periodic-orbits-with-trapezoid-method-1"></a><a class="docs-heading-anchor-permalink" href="#Periodic-orbits-with-trapezoid-method" title="Permalink"></a></h2><p>We compute periodic orbits of (E) using the Trapezoid method. We are now equipped to build a periodic orbit problem from a solution <code>sol::ODEProblem</code>.</p><pre><code class="language-julia hljs"># function to build probtrap from sol
probtrap, ci = BK.generate_ci_problem(PeriodicOrbitTrapProblem(M = 150),
	prob, sol, 2.)

opts_po_cont = ContinuationPar(opts_br, max_steps = 50, tol_stability = 1e-8)
brpo_fold = continuation(probtrap, ci, PALC(), opts_po_cont;
	verbosity = 3, plot = true,
	argspo...
	)

scene = plot(brpo_fold)</code></pre><img src="4b526b2d.svg" alt="Example block output"/><p>We continue w.r.t. to <span>$\epsilon$</span> and find a period-doubling bifurcation.</p><pre><code class="language-julia hljs">prob2 = @set probtrap.prob_vf.lens = (@optic _.œµ)
brpo_pd = continuation(prob2, ci, PALC(), opts_po_cont;
	argspo...
	)
scene = plot(brpo_pd)</code></pre><img src="ef6da897.svg" alt="Example block output"/><h2 id="Periodic-orbits-with-parallel-standard-shooting"><a class="docs-heading-anchor" href="#Periodic-orbits-with-parallel-standard-shooting">Periodic orbits with parallel standard shooting</a><a id="Periodic-orbits-with-parallel-standard-shooting-1"></a><a class="docs-heading-anchor-permalink" href="#Periodic-orbits-with-parallel-standard-shooting" title="Permalink"></a></h2><p>We are now ready to build a periodic orbit problem from a solution <code>sol::ODEProblem</code>.</p><pre><code class="language-julia hljs">probsh, cish = generate_ci_problem( ShootingProblem(M=3),
	prob, prob_de, sol, 2.; alg = Rodas5(), abstol = 1e-12, reltol = 1e-10)

opts_po_cont = ContinuationPar(opts_br, max_steps = 50, tol_stability = 1e-3)
br_fold_sh = continuation(probsh, cish, PALC(tangent = Bordered()), opts_po_cont;
	argspo...
)

scene = plot(br_fold_sh)</code></pre><img src="916d7cc4.svg" alt="Example block output"/><p>We continue w.r.t. to <span>$\epsilon$</span> and find a period-doubling bifurcation.</p><pre><code class="language-julia hljs">probsh2 = @set probsh.lens = @optic _.œµ
brpo_pd_sh = continuation(probsh2, cish, PALC(), opts_po_cont;
	argspo...
	)
scene = plot(brpo_pd_sh)</code></pre><img src="774c255f.svg" alt="Example block output"/><h2 id="Periodic-orbits-with-orthogonal-collocation"><a class="docs-heading-anchor" href="#Periodic-orbits-with-orthogonal-collocation">Periodic orbits with orthogonal collocation</a><a id="Periodic-orbits-with-orthogonal-collocation-1"></a><a class="docs-heading-anchor-permalink" href="#Periodic-orbits-with-orthogonal-collocation" title="Permalink"></a></h2><p>We do the same as in the previous section but using orthogonal collocation. This is the most reliable and precise method for ODE. When the dimension of the ODE is large, it becomes prohibitive.</p><pre><code class="language-julia hljs"># this is the function which builds probcoll from sol
probcoll, ci = generate_ci_problem(PeriodicOrbitOCollProblem(30, 4),
	prob, sol, 2.)

opts_po_cont = ContinuationPar(opts_br, max_steps = 50, tol_stability = 1e-8)
brpo_fold = continuation(probcoll, ci, PALC(), opts_po_cont;
	argspo...
	)
scene = plot(brpo_fold)</code></pre><img src="d10ce88d.svg" alt="Example block output"/><p>We continue w.r.t. to <span>$\epsilon$</span> and find a period-doubling bifurcation.</p><pre><code class="language-julia hljs">prob2 = @set probcoll.prob_vf.lens = @optic _.œµ
brpo_pd = continuation(prob2, ci, PALC(), ContinuationPar(opts_po_cont, dsmax = 5e-3);
	argspo...
	)

scene = plot(brpo_pd)</code></pre><img src="4f8588c3.svg" alt="Example block output"/><h2 id="Continuation-of-Fold-/-PD-of-periodic-orbits-with-Collocation"><a class="docs-heading-anchor" href="#Continuation-of-Fold-/-PD-of-periodic-orbits-with-Collocation">Continuation of Fold / PD of periodic orbits with Collocation</a><a id="Continuation-of-Fold-/-PD-of-periodic-orbits-with-Collocation-1"></a><a class="docs-heading-anchor-permalink" href="#Continuation-of-Fold-/-PD-of-periodic-orbits-with-Collocation" title="Permalink"></a></h2><p>We continue the previously detected fold/period-doubling bifurcations as function of two parameters and detect codim 2 bifurcations. We first start with the computation of the curve of Folds.</p><pre><code class="language-julia hljs">opts_pocoll_fold = ContinuationPar(brpo_fold.contparams, detect_bifurcation = 3, max_steps = 100, p_min = 0.01, p_max = 1.2)
@reset opts_pocoll_fold.newton_options.tol = 1e-12

fold_po_coll2 = continuation(brpo_fold, 1, (@optic _.œµ), opts_pocoll_fold;
		verbosity = 2, plot = true,
		detect_codim2_bifurcation = 2,
		jacobian_ma = :minaug,
		start_with_eigen = false,
		bothside = true,
		)

fold_po_coll1 = continuation(brpo_fold, 2, (@optic _.œµ), opts_pocoll_fold;
		# verbosity = 2, plot = true,
		detect_codim2_bifurcation = 2,
		jacobian_ma = :minaug,
		start_with_eigen = false,
		bothside = true,
		)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"> ‚îå‚îÄ Curve type: <span class="sgr36"><span class="sgr1">FoldPeriodicOrbitCont</span></span>
 ‚îú‚îÄ Number of points: 120
 ‚îú‚îÄ Type of vectors: <span class="sgr36"><span class="sgr1">BorderedArray{Vector{Float64}, Float64}</span></span>
 ‚îú‚îÄ Parameters (:b0, :œµ)
 ‚îú‚îÄ Parameter <span class="sgr36"><span class="sgr1">œµ</span></span> starts at 0.01, ends at 0.7603105198760838
 ‚îú‚îÄ Algo: <span class="sgr36"><span class="sgr1">PALC</span></span>
 ‚îî‚îÄ Special points:

- #  1, <span class="sgr1">endpoint</span> at œµ ‚âà +0.01000000,                                                                     step =   0
- #  2, <span class="sgr34"><span class="sgr1">      R1</span></span> at œµ ‚âà +0.56581407 ‚àà (+0.56580720, +0.56581407), |Œ¥p|=7e-06, [<span class="sgr32"><span class="sgr1">converged</span></span>], Œ¥ = ( 0,  0), step =  49
- #  3, <span class="sgr34"><span class="sgr1">    cusp</span></span> at œµ ‚âà +1.09292263 ‚àà (+1.09287562, +1.09292263), |Œ¥p|=5e-05, [<span class="sgr31"><span class="sgr1">    guess</span></span>], Œ¥ = ( 0,  0), step =  92
- #  4, <span class="sgr1">endpoint</span> at œµ ‚âà +0.74630346,                                                                     step = 120
</code></pre><p>We turn to the computation of the curve of PD points.</p><pre><code class="language-julia hljs">par_pop2 = @set par_pop.b0 = 0.45
sol2 = DifferentialEquations.solve(remake(prob_de, p = par_pop2, u0 = [0.1,0.1,1,0], tspan=(0,1000)), Rodas5())
sol2 = DifferentialEquations.solve(remake(sol2.prob, tspan = (0,10), u0 = sol2[end]), Rodas5())
plot(sol2, xlims= (8,10))

probcoll, ci = generate_ci_problem(PeriodicOrbitOCollProblem(30, 3), re_make(prob, params = sol2.prob.p), sol2, 1.)

prob2 = @set probcoll.prob_vf.lens = @optic _.œµ
brpo_pd = continuation(prob2, ci, PALC(), ContinuationPar(opts_po_cont, dsmax = 5e-3);
	argspo...,
	bothside = true,
	)

opts_pocoll_pd = ContinuationPar(brpo_pd.contparams, max_steps = 40, p_min = 1.e-2, dsmax = 1e-2, ds = -1e-3)
@reset opts_pocoll_pd.newton_options.tol = 1e-12
pd_po_coll2 = continuation(brpo_pd, 2, (@optic _.b0), opts_pocoll_pd;
		detect_codim2_bifurcation = 1,
		start_with_eigen = false,
		jacobian_ma = :minaug,
		normC = norminf,
		bothside = true,
		)

plot(pd_po_coll2, vars = (:œµ, :b0), branchlabel = &quot;PD&quot;)
plot!(fold_po_coll1, fold_po_coll2, branchlabel = [&quot;FOLD&quot;, &quot;FOLD&quot;])</code></pre><img src="8ad9bbcc.svg" alt="Example block output"/><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Kuznetsov"><a class="tag is-link" href="#citeref-Kuznetsov">Kuznetsov</a><blockquote><p>Yu.A. Kuznetsov, S. Muratori, and S. Rinaldi. Bifurcations and chaos in a periodic predator-prey model, Internat. J. Bifur. Chaos Appl. Sci. Engr., 2 (1992), 117-128.</p></blockquote></li></ul></section></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Friday 28 February 2025 19:06">Friday 28 February 2025</span>. Using Julia version 1.10.8.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
