<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Extended Lorenz-84 model (codim 2 + BT/ZH aBS) · Bifurcation Analysis in Julia</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.svg" alt="Bifurcation Analysis in Julia logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Bifurcation Analysis in Julia</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../guidelines/">Overview</a></li><li><a class="tocitem" href="../../tutorials/">Tutorials</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Functionalities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../plotting/">Plotting</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Nonlinear Equations (Newton)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../newton/">Krylov-Newton algorithm</a></li><li><a class="tocitem" href="../../../deflatedproblem/">Deflated problems</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Periodic Orbits</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../periodicOrbit/">Introduction</a></li><li><a class="tocitem" href="../../../periodicOrbitTrapeze/">Trapezoid</a></li><li><a class="tocitem" href="../../../periodicOrbitCollocation/">Collocation</a></li><li><a class="tocitem" href="../../../periodicOrbitShooting/">Shooting</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Symmetries / Waves</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../intro_wave/">Introduction</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Continuation methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../IntroContinuation/">Introduction</a></li><li><a class="tocitem" href="../../../Predictors/">Predictors / correctors</a></li><li><a class="tocitem" href="../../../PALC/">PALC</a></li><li><a class="tocitem" href="../../../MooreSpence/">Moore-Penrose Continuation</a></li><li><a class="tocitem" href="../../../DeflatedContinuation/">Deflated Continuation</a></li></ul></li><li><a class="tocitem" href="../../../EventCallback/">Event Handling and Callback</a></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">Bifurcations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../detectionBifurcation/">Bifurcation detection (codim 1)</a></li><li><a class="tocitem" href="../../../codim2Continuation/">Fold / Hopf Continuation (codim 2)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-8" type="checkbox"/><label class="tocitem" for="menuitem-4-8"><span class="docs-label">Normal form</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../simplebp/">Simple branch point</a></li><li><a class="tocitem" href="../../../nonsimplebp/">Non-simple branch point</a></li><li><a class="tocitem" href="../../../simplehopf/">Simple Hopf point</a></li><li><a class="tocitem" href="../../../cusp/">Cusp point</a></li><li><a class="tocitem" href="../../../bt/">Bogdanov-Takens point</a></li><li><a class="tocitem" href="../../../bautin/">Bautin point</a></li></ul></li><li><a class="tocitem" href="../../../branchswitching/">Branch switching</a></li><li><a class="tocitem" href="../../../BifurcationDiagram/">Bifurcation diagram</a></li><li><a class="tocitem" href="../../../constrainedproblem/">Constrained problem</a></li><li><a class="tocitem" href="../../../diffeq/">DiffEq wrapper</a></li><li><a class="tocitem" href="../../../iterator/">Iterator Interface</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Options</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../linearsolver/">Linear Solvers</a></li><li><a class="tocitem" href="../../../borderedlinearsolver/">Bordered linear solvers</a></li><li><a class="tocitem" href="../../../eigensolver/">Eigen Solvers</a></li><li><a class="tocitem" href="../../../Borderedarrays/">Bordered arrays</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Contributing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">Interfaces</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../interfaceLS/">Linear/Eigen Solvers</a></li><li><a class="tocitem" href="../../../interfacePred/">Predictor/Corrector</a></li><li><a class="tocitem" href="../../../interfaceFlow/">Flow</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../faq/">Frequently Asked Questions</a></li><li><a class="tocitem" href="../../../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Extended Lorenz-84 model (codim 2 + BT/ZH aBS)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Extended Lorenz-84 model (codim 2 + BT/ZH aBS)</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/bifurcationkit/BifurcationKitDocs.jl/blob/main/docs/src/tutorials/ode/lorenz84.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Extended-Lorenz-84-model-(codim-2-BT/ZH-aBS)"><a class="docs-heading-anchor" href="#Extended-Lorenz-84-model-(codim-2-BT/ZH-aBS)">Extended Lorenz-84 model (codim 2 + BT/ZH aBS)</a><a id="Extended-Lorenz-84-model-(codim-2-BT/ZH-aBS)-1"></a><a class="docs-heading-anchor-permalink" href="#Extended-Lorenz-84-model-(codim-2-BT/ZH-aBS)" title="Permalink"></a></h1><ul><li><a href="#Extended-Lorenz-84-model-(codim-2-BT/ZH-aBS)">Extended Lorenz-84 model (codim 2 + BT/ZH aBS)</a></li><li class="no-marker"><ul><li><a href="#Problem-setting">Problem setting</a></li><li><a href="#Continuation-and-codim-1-bifurcations">Continuation and codim 1 bifurcations</a></li><li><a href="#Continuation-of-Fold-points">Continuation of Fold points</a></li><li><a href="#Continuation-of-Hopf-points">Continuation of Hopf points</a></li><li><a href="#Continuation-of-Hopf-points-from-the-Bogdanov-Takens-bifurcation">Continuation of Hopf points from the Bogdanov-Takens bifurcation</a></li><li><a href="#Continuation-of-Hopf-points-from-the-Zero-Hopf-bifurcation">Continuation of Hopf points from the Zero-Hopf bifurcation</a></li><li><a href="#References">References</a></li></ul></li></ul><p>In this tutorial, we study the extended Lorenz-84 model which is also treated in MatCont <sup class="footnote-reference"><a id="citeref-Kuznetsov" href="#footnote-Kuznetsov">[Kuznetsov]</a></sup>. This model is interesting because it features all codim 2 bifurcations. It is thus convenient to test our algorithms.</p><p>After this tutorial, you will be able to</p><ul><li>detect codim 1 bifurcation Fold / Hopf / Branch point</li><li>follow Fold / Hopf points and detect codim 2 bifurcation points</li><li>branch from the detected codim 2 points to curves of Fold / Hopf points (This part is still &quot;work in progress&quot;)</li></ul><p>The model is as follows</p><p class="math-container">\[\left\{\begin{array}{l}
\dot{X}=-Y^{2}-Z^{2}-\alpha X+\alpha F-\gamma U^{2} \\
\dot{Y}=X Y-\beta X Z-Y+G \\
\dot{Z}=\beta X Y+X Z-Z \\
\dot{U}=-\delta U+\gamma U X+T
\end{array}\right.\tag{E}\]</p><p>We start with some imports that are useful in the following.</p><pre><code class="language-julia hljs">using Revise, ForwardDiff, Parameters, Setfield, Plots, LinearAlgebra
using BifurcationKit
const BK = BifurcationKit

# sup norm
norminf(x) = norm(x, Inf)</code></pre><h2 id="Problem-setting"><a class="docs-heading-anchor" href="#Problem-setting">Problem setting</a><a id="Problem-setting-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-setting" title="Permalink"></a></h2><p>We can now encode the vector field (E) in a function and use automatic differentiation to compute its various derivatives.</p><pre><code class="language-julia hljs"># vector field
function Lor(u, p)
    @unpack α,β,γ,δ,G,F,T = p
	X,Y,Z,U = u
	[
		-Y^2 - Z^2 - α*X + α*F - γ*U^2,
		X*Y - β*X*Z - Y + G,
		β*X*Y + X*Z - Z,
		-δ*U + γ*U*X + T
	]
end

# we group the differentials together
jet = BK.getJet(Lor;matrixfree=false)

# parameter values
parlor = (α = 1//4, β = 1, G = .25, δ = 1.04, γ = 0.987, F = 1.7620532879639, T = .0001265)

# initial condition
z0 =  [2.9787004394953343, -0.03868302503393752,  0.058232737694740085, -0.02105288273117459]</code></pre><h2 id="Continuation-and-codim-1-bifurcations"><a class="docs-heading-anchor" href="#Continuation-and-codim-1-bifurcations">Continuation and codim 1 bifurcations</a><a id="Continuation-and-codim-1-bifurcations-1"></a><a class="docs-heading-anchor-permalink" href="#Continuation-and-codim-1-bifurcations" title="Permalink"></a></h2><p>Once the problem is set up, we can continue the state w.r.t. <span>$F$</span> to and detect codim 1 bifurcations. This is achieved as follows:</p><pre><code class="language- hljs"># continuation options
opts_br = ContinuationPar(pMin = -1.5, pMax = 3.0, ds = 0.002, dsmax = 0.15,
	# options to detect codim 1 bifurcations using bisection
	detectBifurcation = 3,
	# Optional: bisection options for locating bifurcations
	nInversion = 6, maxBisectionSteps = 25,
	# number of eigenvalues
	nev = 4, maxSteps = 200)

# compute the branch of solutions
br, = @time continuation(jet[1], jet[2], z0, setproperties(parlor; T=0.04, F=3.), (@lens _.F), opts_br;
	recordFromSolution = (x, p) -&gt; (X = x[1], Y = x[2], Z = x[3], U = x[4]),
	normC = norminf,
	bothside = true)

scene = plot(br, plotfold=false, markersize=4, legend=:topleft)</code></pre><p>With detailed information:</p><pre><code class="language- hljs">br</code></pre><h2 id="Continuation-of-Fold-points"><a class="docs-heading-anchor" href="#Continuation-of-Fold-points">Continuation of Fold points</a><a id="Continuation-of-Fold-points-1"></a><a class="docs-heading-anchor-permalink" href="#Continuation-of-Fold-points" title="Permalink"></a></h2><p>We follow the Fold points in the parameter plane <span>$(T,F)$</span>. We tell the solver to consider <code>br.specialpoint[4]</code> and continue it.</p><pre><code class="language- hljs"># function to record the current state
recordFromSolutionLor(x, p) = ((X = x.u[1], Y = x.u[2], Z = x.u[3], U = x.u[4]))

sn_codim2, = continuation(jet[1:2]..., br, 4, (@lens _.T), ContinuationPar(opts_br, pMax = 3.2, pMin = -0.1, detectBifurcation = 1, dsmin=1e-5, ds = -0.001, dsmax = 0.005, nInversion = 10, saveSolEveryStep = 1, maxSteps = 130, maxBisectionSteps = 55) ; normC = norminf,
	# detection of codim 2 bifurcations with bisection
	detectCodim2Bifurcation = 2,
	# we update the Fold problem at every continuation step
	updateMinAugEveryStep = 1,
	startWithEigen = false,
	# we save the different components for plotting
	recordFromSolution = recordFromSolutionLor,
	# give analytic higher differentials, useful for normal forms
	d2F = jet[3], d3F = jet[4],
	)

scene = plot(sn_codim2, vars=(:X, :U), branchlabel = &quot;Folds&quot;, ylims=(-0.5, 0.5))</code></pre><p>with detailed information</p><pre><code class="language- hljs">sn_codim2</code></pre><p>For example, we can compute the following normal form</p><pre><code class="language- hljs">computeNormalForm(jet..., sn_codim2, 1; nev = 4)</code></pre><h2 id="Continuation-of-Hopf-points"><a class="docs-heading-anchor" href="#Continuation-of-Hopf-points">Continuation of Hopf points</a><a id="Continuation-of-Hopf-points-1"></a><a class="docs-heading-anchor-permalink" href="#Continuation-of-Hopf-points" title="Permalink"></a></h2><p>We follow the Hopf points in the parameter plane <span>$(T,F)$</span>. We tell the solver to consider <code>br.specialpoint[2]</code> and continue it.</p><pre><code class="language- hljs">hp_codim2_1, = continuation(jet[1:2]..., br, 2, (@lens _.T), ContinuationPar(opts_br, ds = -0.001, dsmax = 0.02, dsmin = 1e-4, nInversion = 6, saveSolEveryStep = 1, detectBifurcation = 1) ; normC = norminf,
	# tangent algorithm
	tangentAlgo = BorderedPred(),
	# detection of codim 2 bifurcations with bisection
	detectCodim2Bifurcation = 2,
	# we update the Fold problem at every continuation step
	updateMinAugEveryStep = 1,
	# we save the different components for plotting
	recordFromSolution = recordFromSolutionLor,
	# give analytic higher differentials, useful for normal forms
	d2F = jet[3], d3F = jet[4],
	# compute both sides of the initial condition
	bothside = true,
	)

plot(sn_codim2, vars=(:X, :U), branchlabel = &quot;Folds&quot;)
	plot!(hp_codim2_1, vars=(:X, :U), branchlabel = &quot;Hopfs&quot;)
	ylims!(-0.7,0.7);xlims!(1,1.3)</code></pre><pre><code class="language- hljs">hp_codim2_1</code></pre><p>For example, we can compute the following normal form</p><pre><code class="language- hljs">computeNormalForm(jet..., hp_codim2_1, 2; nev = 4)</code></pre><h2 id="Continuation-of-Hopf-points-from-the-Bogdanov-Takens-bifurcation"><a class="docs-heading-anchor" href="#Continuation-of-Hopf-points-from-the-Bogdanov-Takens-bifurcation">Continuation of Hopf points from the Bogdanov-Takens bifurcation</a><a id="Continuation-of-Hopf-points-from-the-Bogdanov-Takens-bifurcation-1"></a><a class="docs-heading-anchor-permalink" href="#Continuation-of-Hopf-points-from-the-Bogdanov-Takens-bifurcation" title="Permalink"></a></h2><p>When we computed the curve of Fold points, we detected a Bogdanov-Takens bifurcation. We can branch from it to get the curve of Hopf points. This is done as follows:</p><pre><code class="language- hljs">hp_from_bt, = continuation(jet..., sn_codim2, 4, ContinuationPar(opts_br, ds = -0.001, dsmax = 0.02, dsmin = 1e-4,
	nInversion = 6, detectBifurcation = 1) ; normC = norminf,
	# tangent algorithm
	tangentAlgo = BorderedPred(),
	# detection of codim 2 bifurcations with bisection
	detectCodim2Bifurcation = 2,
	# we update the Fold problem at every continuation step
	updateMinAugEveryStep = 1,
	# we save the different components for plotting
	recordFromSolution = recordFromSolutionLor,
	)

plot(sn_codim2, vars=(:X, :U), branchlabel = &quot;SN&quot;)
	plot!(hp_codim2_1, vars=(:X, :U), branchlabel = &quot;Hopf1&quot;)
	plot!(hp_from_bt, vars=(:X, :U), branchlabel = &quot;Hopf2&quot;)
	ylims!(-0.7,0.75);xlims!(0.95,1.3)</code></pre><p>with detailed information</p><pre><code class="language- hljs">hp_from_bt</code></pre><h2 id="Continuation-of-Hopf-points-from-the-Zero-Hopf-bifurcation"><a class="docs-heading-anchor" href="#Continuation-of-Hopf-points-from-the-Zero-Hopf-bifurcation">Continuation of Hopf points from the Zero-Hopf bifurcation</a><a id="Continuation-of-Hopf-points-from-the-Zero-Hopf-bifurcation-1"></a><a class="docs-heading-anchor-permalink" href="#Continuation-of-Hopf-points-from-the-Zero-Hopf-bifurcation" title="Permalink"></a></h2><p>When we computed the curve of Fold points, we detected a Zero-Hopf bifurcation. We can branch from it to get the curve of Hopf points. This is done as follows:</p><pre><code class="language- hljs">hp_from_zh, = continuation(jet..., sn_codim2, 2, ContinuationPar(opts_br, ds = 0.001, dsmax = 0.02, dsmin = 1e-4, nInversion = 6, detectBifurcation = 1, maxSteps = 150) ;
	normC = norminf,
	tangentAlgo = BorderedPred(),
	detectCodim2Bifurcation = 2,
	updateMinAugEveryStep = 1,
	startWithEigen = true,
	recordFromSolution = recordFromSolutionLor,
	bothside = false,
	bdlinsolver = MatrixBLS(),
	)

plot(sn_codim2,vars=(:X, :U),)
	plot!(hp_codim2_1, vars=(:X, :U), branchlabel = &quot;Hopf&quot;)
	plot!(hp_from_bt, vars=(:X, :U),  branchlabel = &quot;Hopf2&quot;)
	plot!( hp_from_zh, vars=(:X, :U), branchlabel = &quot;Hopf&quot;, plotspecialpoints = false, legend = :topleft)
	ylims!(-0.7,0.75);xlims!(0.95,1.3)</code></pre><p>with detailed information</p><pre><code class="language- hljs">hp_from_zh</code></pre><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Kuznetsov"><a class="tag is-link" href="#citeref-Kuznetsov">Kuznetsov</a><blockquote><p>Kuznetsov, Yu A., H. G. E. Meijer, W. Govaerts, and B. Sautois. “Switching to Nonhyperbolic Cycles from Codim 2 Bifurcations of Equilibria in ODEs.” Physica D: Nonlinear Phenomena 237, no. 23 (December 2008): 3061–68.</p></blockquote></li></ul></section></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.21 on <span class="colophon-date" title="Thursday 21 July 2022 10:20">Thursday 21 July 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
