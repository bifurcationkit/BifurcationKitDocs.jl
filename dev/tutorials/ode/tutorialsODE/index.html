<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>üü° Neural mass equation (Hopf aBS) ¬∑ Bifurcation Analysis in Julia</title><meta name="title" content="üü° Neural mass equation (Hopf aBS) ¬∑ Bifurcation Analysis in Julia"/><meta property="og:title" content="üü° Neural mass equation (Hopf aBS) ¬∑ Bifurcation Analysis in Julia"/><meta property="twitter:title" content="üü° Neural mass equation (Hopf aBS) ¬∑ Bifurcation Analysis in Julia"/><meta name="description" content="Documentation for Bifurcation Analysis in Julia."/><meta property="og:description" content="Documentation for Bifurcation Analysis in Julia."/><meta property="twitter:description" content="Documentation for Bifurcation Analysis in Julia."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.svg" alt="Bifurcation Analysis in Julia logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Bifurcation Analysis in Julia</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../capabilities/">Overview of capabilities</a></li><li><a class="tocitem" href="../../../gettingstarted/">Getting Started with BifurcationKit</a></li><li><a class="tocitem" href="../../tutorials/">Tutorials</a></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Basics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../guidelines/">Guidelines</a></li><li><a class="tocitem" href="../../../educational/">Educational introduction</a></li><li><a class="tocitem" href="../../../overview/">Overview</a></li><li><a class="tocitem" href="../../../plotting/">Plot functions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Problems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../BifProblem/">Bifurcation Problem</a></li><li><a class="tocitem" href="../../../diffeq/">DiffEq wrapper</a></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Periodic Orbits</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../periodicOrbit/">Introduction</a></li><li><a class="tocitem" href="../../../periodicOrbitTrapeze/">Trapezoid</a></li><li><a class="tocitem" href="../../../periodicOrbitCollocation/">Collocation</a></li><li><a class="tocitem" href="../../../periodicOrbitShooting/">Shooting</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Symmetries / Waves</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../intro_wave/">Introduction</a></li><li><a class="tocitem" href="../../../waveEigen/">Eigen Solvers</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Continuation methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../IntroContinuation/">Introduction</a></li><li><a class="tocitem" href="../../../Predictors/">Predictors / correctors</a></li><li><a class="tocitem" href="../../../PALC/">PALC</a></li><li><a class="tocitem" href="../../../MooreSpence/">Moore-Penrose continuation</a></li><li><a class="tocitem" href="../../../hybrid/">AutoSwitch</a></li><li><a class="tocitem" href="../../../ANM/">ANM</a></li><li><a class="tocitem" href="../../../DeflatedContinuation/">Deflated continuation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Functionalities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-1" type="checkbox"/><label class="tocitem" for="menuitem-8-1"><span class="docs-label">Nonlinear equations (Newton)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../newton/">Krylov-Newton algorithm</a></li><li><a class="tocitem" href="../../../deflatedproblem/">Deflated problems</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-2" type="checkbox"/><label class="tocitem" for="menuitem-8-2"><span class="docs-label">Bifurcations (equilibria)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../detectionBifurcation/">Bifurcation detection (1 param)</a></li><li><a class="tocitem" href="../../../codim2Continuation/">Fold / Hopf Continuation (2 params)</a></li><li><a class="tocitem" href="../../../codim3Continuation/">Bogdanov-Takens refinement (3 params)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-3" type="checkbox"/><label class="tocitem" for="menuitem-8-3"><span class="docs-label">Bifurcations (periodic orbits)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../detectionBifurcationPO/">Bifurcation detection (1 param)</a></li><li><a class="tocitem" href="../../../FoldContinuationPO/">Fold continuation (2 params)</a></li><li><a class="tocitem" href="../../../PDContinuationPO/">Period-Doubling continuation (2 params)</a></li><li><a class="tocitem" href="../../../NSContinuationPO/">Neimark-Sacker continuation (2 params)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-4" type="checkbox"/><label class="tocitem" for="menuitem-8-4"><span class="docs-label">Normal form (equilibria)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../simplebp/">Simple branch point</a></li><li><a class="tocitem" href="../../../nonsimplebp/">Non-simple branch point</a></li><li><a class="tocitem" href="../../../simplehopf/">Simple Hopf</a></li><li><a class="tocitem" href="../../../cusp/">Cusp</a></li><li><a class="tocitem" href="../../../bt/">Bogdanov-Takens</a></li><li><a class="tocitem" href="../../../bautin/">Bautin</a></li><li><a class="tocitem" href="../../../zh/">Zero-Hopf</a></li><li><a class="tocitem" href="../../../hh/">Hopf-Hopf</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-5" type="checkbox"/><label class="tocitem" for="menuitem-8-5"><span class="docs-label">Normal form (periodic orbits)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../bppo/">Simple branch point</a></li><li><a class="tocitem" href="../../../pd/">Period-doubling</a></li><li><a class="tocitem" href="../../../ns/">Neimark-Sacker</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-6" type="checkbox"/><label class="tocitem" for="menuitem-8-6"><span class="docs-label">Branch switching</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../intro-abs/">Introduction</a></li><li><a class="tocitem" href="../../../abs-from-eq/">From equilibria to equilibria</a></li><li><a class="tocitem" href="../../../abs-from-hopf/">From Hopf/PD/Branch to periodic orbits</a></li><li><a class="tocitem" href="../../../abs-from-codim2-eq/">From codim 2 to equilibria</a></li><li><a class="tocitem" href="../../../abs-from-codim2-po/">From codim 2 to periodic orbits</a></li></ul></li><li><a class="tocitem" href="../../../BifurcationDiagram/">Automatic Bifurcation diagram</a></li><li><a class="tocitem" href="../../../EventCallback/">Event handling and Callback</a></li><li><a class="tocitem" href="../../../iterator/">Iterator Interface</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Options</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../linearsolver/">Linear solvers</a></li><li><a class="tocitem" href="../../../borderedlinearsolver/">Bordered linear solvers</a></li><li><a class="tocitem" href="../../../eigensolver/">Eigen solvers</a></li><li><a class="tocitem" href="../../../Borderedarrays/">Bordered arrays</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Contributing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-10-1" type="checkbox"/><label class="tocitem" for="menuitem-10-1"><span class="docs-label">Interfaces</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../interfaceLS/">Vector</a></li><li><a class="tocitem" href="../../../interfaceLS/">Linear / eigen Solvers</a></li><li><a class="tocitem" href="../../../interfacePred/">Predictor / corrector</a></li><li><a class="tocitem" href="../../../interfaceFlow/">Flow</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../faq/">Frequently asked questions</a></li><li><a class="tocitem" href="../../../migration/">Migration from old versions</a></li><li><a class="tocitem" href="../../../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>üü° Neural mass equation (Hopf aBS)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>üü° Neural mass equation (Hopf aBS)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/bifurcationkit/BifurcationKitDocs.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/bifurcationkit/BifurcationKitDocs.jl/blob/main/docs/src/tutorials/ode/tutorialsODE.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="nmepo"><a class="docs-heading-anchor" href="#nmepo">üü° Neural mass equation (Hopf aBS)</a><a id="nmepo-1"></a><a class="docs-heading-anchor-permalink" href="#nmepo" title="Permalink"></a></h1><ul><li><a href="#nmepo">üü° Neural mass equation (Hopf aBS)</a></li><li class="no-marker"><ul><li><a href="#Branch-of-periodic-orbits-with-Orthogonal-Collocation">Branch of periodic orbits with Orthogonal Collocation</a></li><li><a href="#Periodic-orbits-with-Parallel-Standard-Shooting">Periodic orbits with Parallel Standard Shooting</a></li><li><a href="#Branch-of-periodic-orbits-with-Trapezoid-method">Branch of periodic orbits with Trapezoid method</a></li><li class="no-marker"><ul><li><a href="#Plot-of-some-of-the-periodic-orbits-as-function-of-E_0">Plot of some of the periodic orbits as function of <span>$E_0$</span></a></li></ul></li><li><a href="#References">References</a></li></ul></li></ul><p>The following model is taken from <sup class="footnote-reference"><a id="citeref-Cortes" href="#footnote-Cortes">[Cortes]</a></sup>:</p><p class="math-container">\[\left\{\begin{array}{l}
\tau \dot{E}=-E+g\left(J u x E+E_{0}\right) \\
\dot{x}=\tau_{D}^{-1}(1-x)-u E x \\
\dot{u}=U_0 E(1-u)-\tau_{F}^{-1}(u-U_0)
\end{array}\right.\]</p><p>with</p><p class="math-container">\[g(y):=\alpha\log(1+exp(y/\alpha)).\]</p><p>We use this model as a mean to introduce the basics of <code>BifurcationKit.jl</code>, namely the continuation of equilibria and periodic orbits (with the different methods).</p><p>The model is interesting on its own because the branch of periodic solutions converges to an homoclinic orbit which can be challenging to compute. We provide three different ways to compute these periodic orbits and highlight their pro / cons.</p><p>It is easy to encode the ODE as follows</p><pre><code class="language-julia hljs">using Revise, Plots
using BifurcationKit
const BK = BifurcationKit

# vector field
function TMvf!(dz, z, p, t = 0)
	(;J, Œ±, E0, œÑ, œÑD, œÑF, U0) = p
	E, x, u = z
	SS0 = J * u * x * E + E0
	SS1 = Œ± * log(1 + exp(SS0 / Œ±))
	dz[1] = (-E + SS1) / œÑ
	dz[2] =	(1.0 - x) / œÑD - u * x * E
	dz[3] = (U0 - u) / œÑF +  U0 * (1.0 - u) * E
	dz
end

# parameter values
par_tm = (Œ± = 1.4, œÑ = 0.013, J = 3.07, E0 = -2.0, œÑD = 0.20, U0 = 0.3, œÑF = 1.5)

# initial condition
z0 = [0.238616, 0.982747, 0.367876]

# Bifurcation Problem
prob = BifurcationProblem(TMvf!, z0, par_tm, (@optic _.E0);
	record_from_solution = (x, p; k...) -&gt; (E = x[1], x = x[2], u = x[3]),)</code></pre><p>We first compute the branch of equilibria</p><pre><code class="language-julia hljs"># continuation options
opts_br = ContinuationPar(p_min = -2.0, p_max = -1.)

# continuation of equilibria
br = continuation(prob, PALC(tangent=Bordered()), opts_br; normC = norminf)

scene = plot(br, plotfold=false, markersize=4, legend=:topleft)</code></pre><img src="8f881132.svg" alt="Example block output"/><p>With detailed information:</p><pre><code class="language-julia hljs">br</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"> ‚îå‚îÄ Curve type: <span class="sgr36"><span class="sgr1">EquilibriumCont</span></span>
 ‚îú‚îÄ Number of points: 42
 ‚îú‚îÄ Type of vectors: <span class="sgr36"><span class="sgr1">Vector{Float64}</span></span>
 ‚îú‚îÄ Parameter <span class="sgr36"><span class="sgr1">E0</span></span> starts at -2.0, ends at -1.0
 ‚îú‚îÄ Algo: <span class="sgr36"><span class="sgr1">PALC</span></span>
 ‚îî‚îÄ Special points:

- #  1, <span class="sgr34"><span class="sgr1">      bp</span></span> at E0 ‚âà -1.34913909 ‚àà (-1.34938031, -1.34913909), |Œ¥p|=2e-04, [<span class="sgr32"><span class="sgr1">converged</span></span>], Œ¥ = ( 1,  0), step =  11
- #  2, <span class="sgr34"><span class="sgr1">    hopf</span></span> at E0 ‚âà -1.83157834 ‚àà (-1.83157834, -1.83112490), |Œ¥p|=5e-04, [<span class="sgr32"><span class="sgr1">converged</span></span>], Œ¥ = ( 2,  2), step =  23
- #  3, <span class="sgr34"><span class="sgr1">      bp</span></span> at E0 ‚âà -1.84196262 ‚àà (-1.84196538, -1.84196262), |Œ¥p|=3e-06, [<span class="sgr32"><span class="sgr1">converged</span></span>], Œ¥ = (-1,  0), step =  25
- #  4, <span class="sgr34"><span class="sgr1">    hopf</span></span> at E0 ‚âà -1.13421119 ‚àà (-1.13429114, -1.13421119), |Œ¥p|=8e-05, [<span class="sgr32"><span class="sgr1">converged</span></span>], Œ¥ = (-2, -2), step =  39
- #  5, <span class="sgr1">endpoint</span> at E0 ‚âà -1.00000000,                                                                     step =  41
</code></pre><h2 id="Branch-of-periodic-orbits-with-Orthogonal-Collocation"><a class="docs-heading-anchor" href="#Branch-of-periodic-orbits-with-Orthogonal-Collocation">Branch of periodic orbits with Orthogonal Collocation</a><a id="Branch-of-periodic-orbits-with-Orthogonal-Collocation-1"></a><a class="docs-heading-anchor-permalink" href="#Branch-of-periodic-orbits-with-Orthogonal-Collocation" title="Permalink"></a></h2><p>We compute the branch of periodic orbits from the last Hopf bifurcation point (on the right). We use Orthogonal Collocation to discretize the problem of finding periodic orbits. This is vastly more precise than the following methods because we use mesh adaptation.</p><pre><code class="language-julia hljs"># arguments for periodic orbits
# one function to record information and one
# function for plotting
args_po = (	record_from_solution = (x, p; k...) -&gt; begin
		xtt = get_periodic_orbit(p.prob, x, p.p)
		return (max = maximum(xtt[1,:]),
				min = minimum(xtt[1,:]),
				period = getperiod(p.prob, x, p.p))
	end,
	plot_solution = (x, p; k...) -&gt; begin
		xtt = get_periodic_orbit(p.prob, x, p.p)
		arg = (marker = :d, markersize = 1)
		plot!(xtt.t, xtt[1,:]; label = &quot;E&quot;, arg..., k...)
		plot!(xtt.t, xtt[2,:]; label = &quot;x&quot;, arg..., k...)
		plot!(xtt.t, xtt[3,:]; label = &quot;u&quot;, arg..., k...)
		plot!(br; subplot = 1, putspecialptlegend = false)
		end,
	# we use the supremum norm
	normC = norminf)

# continuation parameters
opts_po_cont = ContinuationPar(opts_br, ds= 0.001, dsmin = 1e-4, dsmax = 0.1,
	max_steps = 110,
	tol_stability = 1e-5)

br_pocoll = @time continuation(
	# we want to branch form the 4th bif. point
	br, 4, opts_po_cont,
	# we want to use the Collocation method to locate PO, with polynomial degree 4
	PeriodicOrbitOCollProblem(50, 4; meshadapt = true);
	# regular continuation options
	plot = true,
	args_po...)

Scene = title!(&quot;&quot;)</code></pre><img src="94bbef4b.svg" alt="Example block output"/><p>Let us plot the periodic orbit close to the end of the branch</p><pre><code class="language-julia hljs">sol = get_periodic_orbit(br_pocoll, 100)
plot(sol, title = &quot;Periodic orbit&quot;, marker = :d, markersize=1)</code></pre><img src="d626b4c5.svg" alt="Example block output"/><h2 id="Periodic-orbits-with-Parallel-Standard-Shooting"><a class="docs-heading-anchor" href="#Periodic-orbits-with-Parallel-Standard-Shooting">Periodic orbits with Parallel Standard Shooting</a><a id="Periodic-orbits-with-Parallel-Standard-Shooting-1"></a><a class="docs-heading-anchor-permalink" href="#Periodic-orbits-with-Parallel-Standard-Shooting" title="Permalink"></a></h2><p>We use a different method to compute periodic orbits: we rely on a fixed point of the flow. To compute the flow, we use <code>DifferentialEquations.jl</code>. This way of computing periodic orbits should be more precise than the Trapezoid method. We use a particular instance called multiple shooting which is computed in parallel. This is an additional advantage compared to the two other methods.</p><pre><code class="language-julia hljs">using DifferentialEquations

# this is the ODEProblem used with `DiffEqBase.solve`
probsh = ODEProblem(TMvf!, copy(z0), (0., 1.), par_tm; abstol = 1e-12, reltol = 1e-10)

opts_po_cont = ContinuationPar(opts_br, dsmax = 0.1, ds= -0.0001, dsmin = 1e-4, max_steps = 110, tol_stability = 1e-4)

br_posh = @time continuation(
	br, 4, opts_po_cont,
	# this is where we tell that we want Standard Shooting
	# with 15 time sections
	ShootingProblem(15, probsh, Rodas5(), parallel = true);
	# regular continuation parameters
	plot = true,
	args_po...,
	# we reject the step when the residual is high
	callback_newton = BK.cbMaxNorm(10)
	)

Scene = title!(&quot;&quot;)</code></pre><img src="0ad46059.svg" alt="Example block output"/><h2 id="Branch-of-periodic-orbits-with-Trapezoid-method"><a class="docs-heading-anchor" href="#Branch-of-periodic-orbits-with-Trapezoid-method">Branch of periodic orbits with Trapezoid method</a><a id="Branch-of-periodic-orbits-with-Trapezoid-method-1"></a><a class="docs-heading-anchor-permalink" href="#Branch-of-periodic-orbits-with-Trapezoid-method" title="Permalink"></a></h2><p>We then compute the branch of periodic orbits from the last Hopf bifurcation point (on the right). We use finite differences to discretize the problem of finding periodic orbits. Obviously, this will be problematic when the period of the limit cycle grows unbounded close to the homoclinic orbit.</p><pre><code class="language-julia hljs"># continuation parameters
opts_po_cont = ContinuationPar(opts_br, dsmax = 0.1, ds = 0.004, dsmin = 1e-4,
	max_steps = 80, tol_stability = 1e-7)

@reset opts_po_cont.newton_options.tol = 1e-7

Mt = 250 # number of time sections
br_potrap = continuation(
	# we want to branch form the 4th bif. point
	br, 4, opts_po_cont,
	# we want to use the Trapeze method to locate PO
	PeriodicOrbitTrapProblem(M = Mt);
	Œ¥p = 0.001,
	plot = true,
	args_po...,
	)

scene = plot(br, br_potrap, markersize = 3)
plot!(scene, br_potrap.param, br_potrap.min, label = &quot;&quot;)</code></pre><img src="7077f0c2.svg" alt="Example block output"/><p>We plot the maximum (resp. minimum) of the limit cycle. We can see that the min converges to the smallest equilibrium indicating a homoclinic orbit.</p><h3 id="Plot-of-some-of-the-periodic-orbits-as-function-of-E_0"><a class="docs-heading-anchor" href="#Plot-of-some-of-the-periodic-orbits-as-function-of-E_0">Plot of some of the periodic orbits as function of <span>$E_0$</span></a><a id="Plot-of-some-of-the-periodic-orbits-as-function-of-E_0-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-of-some-of-the-periodic-orbits-as-function-of-E_0" title="Permalink"></a></h3><p>We can plot some of the previously computed periodic orbits in the plane <span>$(E,x)$</span> as function of <span>$E_0$</span>:</p><pre><code class="language-julia hljs">plot()
# fetch the saved solutions
for i_sol in 1:2:40
	traj = get_periodic_orbit(br_potrap, i_sol)
	plot!(traj[1,:], traj[2,:], xlabel = &quot;E&quot;, ylabel = &quot;x&quot;, label = &quot;&quot;)
end
title!(&quot;&quot;)</code></pre><img src="a62069e5.svg" alt="Example block output"/><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Cortes"><a class="tag is-link" href="#citeref-Cortes">Cortes</a><blockquote><p>Cortes, Jesus M., Mathieu Desroches, Serafim Rodrigues, Romain Veltz, Miguel A. Mu√±oz, and Terrence J. Sejnowski. <strong>Short-Term Synaptic Plasticity in the Deterministic Tsodyks‚ÄìMarkram Model Leads to Unpredictable Network Dynamics.</strong>‚Äù Proceedings of the National Academy of Sciences 110, no. 41 (October 8, 2013): 16610‚Äì15. https://doi.org/10.1073/pnas.1316071110.</p></blockquote></li></ul></section></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Monday 7 April 2025 16:19">Monday 7 April 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
