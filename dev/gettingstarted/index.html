<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Getting Started with BifurcationKit · Bifurcation Analysis in Julia</title><meta name="title" content="Getting Started with BifurcationKit · Bifurcation Analysis in Julia"/><meta property="og:title" content="Getting Started with BifurcationKit · Bifurcation Analysis in Julia"/><meta property="twitter:title" content="Getting Started with BifurcationKit · Bifurcation Analysis in Julia"/><meta name="description" content="Documentation for Bifurcation Analysis in Julia."/><meta property="og:description" content="Documentation for Bifurcation Analysis in Julia."/><meta property="twitter:description" content="Documentation for Bifurcation Analysis in Julia."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Bifurcation Analysis in Julia logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Bifurcation Analysis in Julia</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../capabilities/">Overview of capabilities</a></li><li class="is-active"><a class="tocitem" href>Getting Started with BifurcationKit</a><ul class="internal"><li><a class="tocitem" href="#Example-1:-solving-the-perturbed-pitchfork-equation"><span>Example 1: solving the perturbed pitchfork equation</span></a></li><li><a class="tocitem" href="#Example-2:-simple-branching"><span>Example 2: simple branching</span></a></li><li><a class="tocitem" href="#gt-hopf"><span>Example 3: continuing periodic orbits</span></a></li></ul></li><li><a class="tocitem" href="../tutorials/tutorials/">Tutorials</a></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Basics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../guidelines/">Guidelines</a></li><li><a class="tocitem" href="../educational/">Educational introduction</a></li><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../plotting/">Plot functions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Problems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../BifProblem/">Bifurcation Problem</a></li><li><a class="tocitem" href="../diffeq/">DiffEq wrapper</a></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Periodic Orbits</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../periodicOrbit/">Introduction</a></li><li><a class="tocitem" href="../periodicOrbitTrapeze/">Trapezoid</a></li><li><a class="tocitem" href="../periodicOrbitCollocation/">Collocation</a></li><li><a class="tocitem" href="../periodicOrbitShooting/">Shooting</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Symmetries / Waves</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../intro_wave/">Introduction</a></li><li><a class="tocitem" href="../waveEigen/">Eigen Solvers</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Continuation methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../IntroContinuation/">Introduction</a></li><li><a class="tocitem" href="../Predictors/">Predictors / correctors</a></li><li><a class="tocitem" href="../PALC/">PALC</a></li><li><a class="tocitem" href="../MooreSpence/">Moore-Penrose continuation</a></li><li><a class="tocitem" href="../hybrid/">AutoSwitch</a></li><li><a class="tocitem" href="../ANM/">ANM</a></li><li><a class="tocitem" href="../DeflatedContinuation/">Deflated continuation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Functionalities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-1" type="checkbox"/><label class="tocitem" for="menuitem-8-1"><span class="docs-label">Nonlinear equations (Newton)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../newton/">Krylov-Newton algorithm</a></li><li><a class="tocitem" href="../deflatedproblem/">Deflated problems</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-2" type="checkbox"/><label class="tocitem" for="menuitem-8-2"><span class="docs-label">Bifurcations (equilibria)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../detectionBifurcation/">Bifurcation detection (1 param)</a></li><li><a class="tocitem" href="../codim2Continuation/">Fold / Hopf Continuation (2 params)</a></li><li><a class="tocitem" href="../codim3Continuation/">Bogdanov-Takens refinement (3 params)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-3" type="checkbox"/><label class="tocitem" for="menuitem-8-3"><span class="docs-label">Bifurcations (periodic orbits)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../detectionBifurcationPO/">Bifurcation detection (1 param)</a></li><li><a class="tocitem" href="../FoldContinuationPO/">Fold continuation (2 params)</a></li><li><a class="tocitem" href="../PDContinuationPO/">Period-Doubling continuation (2 params)</a></li><li><a class="tocitem" href="../NSContinuationPO/">Neimark-Sacker continuation (2 params)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-4" type="checkbox"/><label class="tocitem" for="menuitem-8-4"><span class="docs-label">Normal form (equilibria)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../simplebp/">Simple branch point</a></li><li><a class="tocitem" href="../nonsimplebp/">Non-simple branch point</a></li><li><a class="tocitem" href="../simplehopf/">Simple Hopf</a></li><li><a class="tocitem" href="../cusp/">Cusp</a></li><li><a class="tocitem" href="../bt/">Bogdanov-Takens</a></li><li><a class="tocitem" href="../bautin/">Bautin</a></li><li><a class="tocitem" href="../zh/">Zero-Hopf</a></li><li><a class="tocitem" href="../hh/">Hopf-Hopf</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-5" type="checkbox"/><label class="tocitem" for="menuitem-8-5"><span class="docs-label">Normal form (periodic orbits)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../bppo/">Simple branch point</a></li><li><a class="tocitem" href="../pd/">Period-doubling</a></li><li><a class="tocitem" href="../ns/">Neimark-Sacker</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-6" type="checkbox"/><label class="tocitem" for="menuitem-8-6"><span class="docs-label">Branch switching</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../intro-abs/">Introduction</a></li><li><a class="tocitem" href="../abs-from-eq/">From equilibria to equilibria</a></li><li><a class="tocitem" href="../abs-from-hopf/">From Hopf/PD/Branch to periodic orbits</a></li><li><a class="tocitem" href="../abs-from-codim2-eq/">From codim 2 to equilibria</a></li><li><a class="tocitem" href="../abs-from-codim2-po/">From codim 2 to periodic orbits</a></li></ul></li><li><a class="tocitem" href="../BifurcationDiagram/">Automatic Bifurcation diagram</a></li><li><a class="tocitem" href="../EventCallback/">Event handling and Callback</a></li><li><a class="tocitem" href="../iterator/">Iterator Interface</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Options</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../linearsolver/">Linear solvers</a></li><li><a class="tocitem" href="../borderedlinearsolver/">Bordered linear solvers</a></li><li><a class="tocitem" href="../eigensolver/">Eigen solvers</a></li><li><a class="tocitem" href="../Borderedarrays/">Bordered arrays</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Contributing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-10-1" type="checkbox"/><label class="tocitem" for="menuitem-10-1"><span class="docs-label">Interfaces</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../interfaceLS/">Vector</a></li><li><a class="tocitem" href="../interfaceLS/">Linear / eigen Solvers</a></li><li><a class="tocitem" href="../interfacePred/">Predictor / corrector</a></li><li><a class="tocitem" href="../interfaceFlow/">Flow</a></li></ul></li></ul></li><li><a class="tocitem" href="../faq/">Frequently asked questions</a></li><li><a class="tocitem" href="../migration/">Migration from old versions</a></li><li><a class="tocitem" href="../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Getting Started with BifurcationKit</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Getting Started with BifurcationKit</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/bifurcationkit/BifurcationKitDocs.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/bifurcationkit/BifurcationKitDocs.jl/blob/main/docs/src/gettingstarted.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Get-Started-with-BifurcationKit"><a class="docs-heading-anchor" href="#Get-Started-with-BifurcationKit">🚀 Get Started with BifurcationKit</a><a id="Get-Started-with-BifurcationKit-1"></a><a class="docs-heading-anchor-permalink" href="#Get-Started-with-BifurcationKit" title="Permalink"></a></h1><p>This tutorial will introduce you to the functionalities for computing bifurcation diagrams and follow branches of solutions.</p><h2 id="Example-1:-solving-the-perturbed-pitchfork-equation"><a class="docs-heading-anchor" href="#Example-1:-solving-the-perturbed-pitchfork-equation">Example 1: solving the perturbed pitchfork equation</a><a id="Example-1:-solving-the-perturbed-pitchfork-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Example-1:-solving-the-perturbed-pitchfork-equation" title="Permalink"></a></h2><p>In this example, we will solve the equation</p><p class="math-container">\[\mu + x-\frac{x^3}{3}=0\]</p><p>as function of <span>$\mu$</span> by looking at the solutions in the connected component of <span>$(x_0,\mu_0)\approx(-2,-1)$</span>. Here <span>$x\in\mathbb R$</span> is the state variable and <span>$\mu$</span> is our parameter. The general workflow is to define a problem, solve the problem, and then analyze the solution. The full code for solving this problem is:</p><pre><code class="language-julia hljs">using BifurcationKit, Plots
F(x, p) = @. p[1] + x - x^3/3
prob = BifurcationProblem(F, [-2.], [-1.], 1;
    record_from_solution = (x,p; k...) -&gt; x[1])
br = continuation(prob, PALC(), ContinuationPar(p_min = -1., p_max = 1.))
plot(br)</code></pre><img src="5b9c1d3d.svg" alt="Example block output"/><p>where the pieces are described below.</p><h3 id="Step-1:-Defining-a-problem"><a class="docs-heading-anchor" href="#Step-1:-Defining-a-problem">Step 1: Defining a problem</a><a id="Step-1:-Defining-a-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-Defining-a-problem" title="Permalink"></a></h3><p>To solve this numerically, we define a problem type by giving it the equation, the initial condition, the parameters and the parameter axis to solve over:</p><pre><code class="language-julia hljs">prob = BifurcationProblem(F,
        [-2.], # initial condition x0
        [-1.], # set of parameters
        1;     # parameter index for continuation
        record_from_solution = (x,p; k...) -&gt; x[1])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌─ Bifurcation Problem with uType <span class="sgr36"><span class="sgr1">Vector{Float64}</span></span>
├─ Inplace:  <span class="sgr36"><span class="sgr1">false</span></span>
├─ Dimension:  <span class="sgr36"><span class="sgr1">1</span></span>
├─ Symmetric: <span class="sgr36"><span class="sgr1">false</span></span>
└─ Parameter: <span class="sgr36"><span class="sgr1">p</span></span></code></pre><p>Note that BifurcationKit.jl will choose the types for the problem based on the types used to define the problem type. For our example, notice that <code>u0</code> is a <code>Vector{Float64}</code>, and therefore this will solve with the dependent variables being <code>Vector{Float64}</code>. You can use this to choose to solve with <code>Float32</code> for example to run this on the GPU (see <a href="../tutorials/tutorials2b/#sh2dgpu">example</a>).</p><p>You can customize a few scalar indicators for each step (for example if you don&#39;t want to save all solutions) by providing a function <code>record_from_solution</code>. You can also control how the solution is plotted during a continuation run by providing a function <code>plot_solution</code>. This is especially useful when studying PDE for example.</p><h3 id="Step-2:-Solving-a-problem"><a class="docs-heading-anchor" href="#Step-2:-Solving-a-problem">Step 2: Solving a problem</a><a id="Step-2:-Solving-a-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-Solving-a-problem" title="Permalink"></a></h3><p>After defining a problem, you &quot;solve&quot; it using <code>continuation</code>.</p><pre><code class="language-julia hljs">br = continuation(prob, PALC(), ContinuationPar(p_min = -1., p_max = 1.))</code></pre><p>The solvers can be controlled using the available options <code>ContinuationPar</code>. For example, we can increase the maximum continuation step (in order to get a less points) by using the command <code>dsmax = 0.25</code></p><pre><code class="language-julia hljs">using Plots
opts = ContinuationPar(p_min = -1., p_max = 1., dsmax = 0.25, max_steps = 1000)
br = continuation(prob, PALC(), opts)
scene = plot(br)</code></pre><img src="0bddbad5.svg" alt="Example block output"/><h3 id="Choosing-a-continuation-algorithm"><a class="docs-heading-anchor" href="#Choosing-a-continuation-algorithm">Choosing a continuation algorithm</a><a id="Choosing-a-continuation-algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Choosing-a-continuation-algorithm" title="Permalink"></a></h3><p>BifurcationKit.jl offers a much wider variety of continuation algorithms than traditional continuation softwares. Many of these algorithms are from recent research and have their own strengths and weaknesses. Each algoritm comes with a doc string, for example <a href="../library/#BifurcationKit.PALC"><code>PALC</code></a>. You can also chose a different tangent predictor in <code>PALC</code></p><pre><code class="language-julia hljs">opts = ContinuationPar(p_min = -1., p_max = 1.)
br = continuation(prob, PALC(tangent = Bordered()), opts)
scene = plot(br)</code></pre><img src="dd1b5620.svg" alt="Example block output"/><p>or you can use the Moore-Penrose continuation algorithm</p><pre><code class="language-julia hljs">opts = ContinuationPar(p_min = -1., p_max = 1.)
br = continuation(prob, MoorePenrose(), opts)
scene = plot(br)</code></pre><img src="83fa96cb.svg" alt="Example block output"/><h3 id="Step-3:-Analyzing-the-solution"><a class="docs-heading-anchor" href="#Step-3:-Analyzing-the-solution">Step 3: Analyzing the solution</a><a id="Step-3:-Analyzing-the-solution-1"></a><a class="docs-heading-anchor-permalink" href="#Step-3:-Analyzing-the-solution" title="Permalink"></a></h3><p>The result of <code>continuation</code> is a solution object. A summary of the result is provided by the <code>show</code> method:</p><pre><code class="language-julia hljs">show(br) # this is equivalent to the REPL julia&gt; br</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"> ┌─ Curve type: EquilibriumCont
 ├─ Number of points: 55
 ├─ Type of vectors: Vector{Float64}
 ├─ Parameter p starts at -1.0, ends at 1.0
 ├─ Algo: MoorePenrose
 └─ Special points:

- #  1,       bp at p ≈ +0.66597167 ∈ (+0.66597167, +0.66658738), |δp|=6e-04, [converged], δ = ( 1,  0), step =  20
- #  2,       bp at p ≈ -0.66665277 ∈ (-0.66666619, -0.66665277), |δp|=1e-05, [converged], δ = (-1,  0), step =  38
- #  3, endpoint at p ≈ +1.00000000,                                                                     step =  54</code></pre><p>From there, you can see that the branch has 55 points, the algorithm is also recalled because it can be modified internally. This summary shows that two bifurcation points where detected. At each such point, the couple <code>δ</code> indicates how many real/complex eigenvalues crossed the imaginary axis. This is useful for debugging or when non generic bifurcations are encountered.</p><p>We can access the 5th value of the branch with:</p><pre><code class="language-julia hljs">br[5]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(x = -2.0742615684285792, param = -0.9006174451276318, itnewton = 2, itlinear = 0, ds = 0.04102643120243098, n_unstable = 0, n_imag = 0, stable = true, step = 4, eigenvals = ComplexF64[-3.3025610542597894 + 0.0im], eigenvecs = ComplexF64[1.0 + 0.0im;;])</code></pre><p>The solution contains many other fields:</p><pre><code class="language-julia hljs">propertynames(br)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(:branch, :eig, :sol, :contparams, :kind, :prob, :specialpoint, :alg)</code></pre><p>Hence, the eigenelements are saved in <code>br.eig</code>, the solutions are saved in <code>br.sol</code> and the bifurcation points in <code>br.specialpoint</code>.</p><h3 id="Plotting-branches"><a class="docs-heading-anchor" href="#Plotting-branches">Plotting branches</a><a id="Plotting-branches-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-branches" title="Permalink"></a></h3><p>While one can directly plot solution time points using the tools given above, convenience commands are defined by recipes for Plots.jl. To plot the solution object, simply call plot:</p><pre><code class="language-julia hljs">#]add Plots # You need to install Plots.jl before your first time using it!
using Plots
#plotly() # You can optionally choose a plotting backend
plot(br)</code></pre><img src="cfa611d9.svg" alt="Example block output"/><h2 id="Example-2:-simple-branching"><a class="docs-heading-anchor" href="#Example-2:-simple-branching">Example 2: simple branching</a><a id="Example-2:-simple-branching-1"></a><a class="docs-heading-anchor-permalink" href="#Example-2:-simple-branching" title="Permalink"></a></h2><p>In this example, we will solve the equation</p><p class="math-container">\[0 = x\cdot(\mu-x)\]</p><p>as function of <span>$\mu$</span>. Here <span>$u\in\mathbb R$</span> is the state variable and <span>$\mu$</span> is our parameter.</p><p>In our example, we know by calculus that the solutions to this equation are <span>$u_0(\mu)=0$</span> and <span>$u_1(\mu)=\mu$</span> but we will use BifurcationKit.jl to solve this problem numerically, which is essential for problems where a symbolic solution is not known.</p><p>In case we know there are many branches, the best is to use an automatic method to compute them all. We will focus on <code>bifurcationdiagram</code> which computes the connected component of the initial guess in the plane <span>$(x,\mu)$</span>. An alternative is to use <a href="../DeflatedContinuation/#Deflated-Continuation">Deflated Continuation</a>.</p><p>We define a problem type by giving it the equation, the initial condition, the parameters and the parameter axis to solve over:</p><pre><code class="language-julia hljs">using Plots
using BifurcationKit

Fbp(u, p) = @. u * (p[1] - u)

# bifurcation problem
prob = BifurcationProblem(Fbp, [0.0], [-0.2],
	# specify the continuation parameter or its index
	1,
	record_from_solution = (x, p; k...) -&gt; x[1])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌─ Bifurcation Problem with uType <span class="sgr36"><span class="sgr1">Vector{Float64}</span></span>
├─ Inplace:  <span class="sgr36"><span class="sgr1">false</span></span>
├─ Dimension:  <span class="sgr36"><span class="sgr1">1</span></span>
├─ Symmetric: <span class="sgr36"><span class="sgr1">false</span></span>
└─ Parameter: <span class="sgr36"><span class="sgr1">p</span></span></code></pre><p>We then aim at calling <code>bifurcationdiagram</code> which will do the jobs of computing recursively the branches which are connected together. Compared to <code>continuation</code>, <code>bifurcationdiagram</code> requires the maximal level of recursion (in this case 2 because there are 2 branches) and a function providing the continuation parameters for each branch (which may differ from branch to branch if the user decides). This explains the following code: </p><pre><code class="language-julia hljs"># options for continuation
opts_br = ContinuationPar(
	# parameter interval
	p_max = 0.2, p_min = -0.2,
	# detect bifurcations with bisection method
	# we increase the precision of the bisection
	n_inversion = 4)

# automatic bifurcation diagram computation
diagram = bifurcationdiagram(prob, PALC(),
	# very important parameter. This specifies the maximum amount of recursion
	# when computing the bifurcation diagram. It means we allow computing branches of branches
	# at most in the present case.
	2,
	opts_br,
	)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[Bifurcation diagram]
 ┌─ From 0-th bifurcation point.
 ├─ Children number: 2
 └─ Root (recursion level 1)
      ┌─ Curve type: <span class="sgr36"><span class="sgr1">EquilibriumCont</span></span>
      ├─ Number of points: 9
      ├─ Type of vectors: <span class="sgr36"><span class="sgr1">Vector{Float64}</span></span>
      ├─ Parameter <span class="sgr36"><span class="sgr1">p</span></span> starts at -0.2, ends at 0.2
      ├─ Algo: <span class="sgr36"><span class="sgr1">PALC</span></span>
      └─ Special points:

- #  1, <span class="sgr34"><span class="sgr1">      bp</span></span> at p ≈ +0.00108349 ∈ (-0.00333593, +0.00108349), |δp|=4e-03, [<span class="sgr32"><span class="sgr1">converged</span></span>], δ = ( 1,  0), step =   6
- #  2, <span class="sgr1">endpoint</span> at p ≈ +0.20000000,                                                                     step =   8
</code></pre><p>You can plot the diagram like</p><pre><code class="language-julia hljs">plot(diagram)</code></pre><img src="31520681.svg" alt="Example block output"/><h2 id="gt-hopf"><a class="docs-heading-anchor" href="#gt-hopf">Example 3: continuing periodic orbits</a><a id="gt-hopf-1"></a><a class="docs-heading-anchor-permalink" href="#gt-hopf" title="Permalink"></a></h2><p>In this example, we will compute periodic orbits of the Stuart-Landau oscillator:</p><p class="math-container">\[\begin{aligned}
\frac{du}{dt} &amp;= r  u - \nu v - (u^2+v^2)  (c_3  u - \mu v) \\
\frac{dv}{dt} &amp;= r  v + \nu u - (u^2+v^2)  (c_3 + \mu  u).
\end{aligned}\]</p><p>The ODE is easily written with a function:</p><pre><code class="language-julia hljs">using BifurcationKit, Plots

function Fsl(X, p)
    (;r, μ, ν, c3) = p
    u, v = X
    ua = u^2 + v^2
    [
        r * u - ν * v - ua * (c3 * u - μ * v)
        r * v + ν * u - ua * (c3 * v + μ * u)
    ]
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Fsl (generic function with 1 method)</code></pre><p>and then we can use this to define a bifurcation problem:</p><pre><code class="language-julia hljs">par_sl = (r = 0.1, μ = 0., ν = 1.0, c3 = 1.0)
u0 = zeros(2)
prob = BifurcationProblem(Fsl, u0, par_sl, (@optic _.r))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌─ Bifurcation Problem with uType <span class="sgr36"><span class="sgr1">Vector{Float64}</span></span>
├─ Inplace:  <span class="sgr36"><span class="sgr1">false</span></span>
├─ Dimension:  <span class="sgr36"><span class="sgr1">2</span></span>
├─ Symmetric: <span class="sgr36"><span class="sgr1">false</span></span>
└─ Parameter: <span class="sgr36"><span class="sgr1">r</span></span></code></pre><p>For this simple problem, we detect the existence of periodic orbits by locating a Hopf bifurcation. This is done as in the previous example by continuing the zero solution:</p><pre><code class="language-julia hljs">br = continuation(prob, PALC(), ContinuationPar(), bothside = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"> ┌─ Curve type: <span class="sgr36"><span class="sgr1">EquilibriumCont</span></span>
 ├─ Number of points: 25
 ├─ Type of vectors: <span class="sgr36"><span class="sgr1">Vector{Float64}</span></span>
 ├─ Parameter <span class="sgr36"><span class="sgr1">r</span></span> starts at -1.0, ends at 1.0
 ├─ Algo: <span class="sgr36"><span class="sgr1">PALC</span></span>
 └─ Special points:

- #  1, <span class="sgr1">endpoint</span> at r ≈ -1.00000000,                                                                     step =   0
- #  2, <span class="sgr34"><span class="sgr1">    hopf</span></span> at r ≈ -0.00595553 ∈ (-0.00595553, +0.00299379), |δp|=9e-03, [<span class="sgr32"><span class="sgr1">converged</span></span>], δ = ( 2,  2), step =   8
- #  3, <span class="sgr1">endpoint</span> at r ≈ +1.00000000,                                                                     step =  24
</code></pre><p>In the result above, we see that a Hopf bifurcation has been detected: </p><p><code>- #  2,     hopf at r ≈ -0.00595553 ∈ (-0.00595553,...</code></p><p>We compute the branch of periodic orbits which is nearby. We thus provide the branch <code>br</code>, the index of the special point we want to branch from: 2 in this case and a method <code>PeriodicOrbitOCollProblem(20, 5)</code> to compute periodic orbits. You can look at <a href="../periodicOrbit/#Periodic-orbits-computation">Periodic orbits computation</a> for a list of all methods. Suffice it to say that <code>PeriodicOrbitOCollProblem</code> is the default method in the case of ODEs.</p><pre><code class="language-julia hljs">br_po = continuation(br, 2, ContinuationPar(),
        PeriodicOrbitOCollProblem(20, 5)
        )</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"> ┌─ Curve type: <span class="sgr36"><span class="sgr1">PeriodicOrbitCont from Hopf bifurcation point.</span></span>
 ├─ Number of points: 15
 ├─ Type of vectors: <span class="sgr36"><span class="sgr1">Vector{Float64}</span></span>
 ├─ Parameter <span class="sgr36"><span class="sgr1">r</span></span> starts at 0.00404446825657828, ends at 1.0
 ├─ Algo: <span class="sgr36"><span class="sgr1">PALC</span></span>
 └─ Special points:

- #  1, <span class="sgr1">endpoint</span> at r ≈ +1.00000000,                                                                     step =  14
</code></pre><h3 id="Analyzing-the-solution"><a class="docs-heading-anchor" href="#Analyzing-the-solution">Analyzing the solution</a><a id="Analyzing-the-solution-1"></a><a class="docs-heading-anchor-permalink" href="#Analyzing-the-solution" title="Permalink"></a></h3><p>The branch of periodic orbits has been computed. You can look at what is recorded in the first point on the branch:</p><pre><code class="language-julia hljs">br_po[1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(max = 0.06359613398726305, min = -0.06359613398726306, amplitude = 0.1271922679745261, period = 6.283185307179592, param = 0.00404446825657828, itnewton = 0, itlinear = 0, ds = 0.01, n_unstable = 0, n_imag = 0, stable = true, step = 0, eigenvals = ComplexF64[-9.731548900096698e-12 + 0.0im, -0.05082428707935453 + 0.0im], eigenvecs = ComplexF64[-1.568290769353517e-14 + 0.0im -1.0 + 0.0im; -1.0 + 0.0im 1.3442492308744432e-14 + 0.0im])</code></pre><p>It shows that the maximum/minimum/amplitude/period of the periodic orbit are recorded by default. You can also plot all the branches as follows</p><pre><code class="language-julia hljs">plot(br, br_po, branchlabel = [&quot;equilibria&quot;, &quot;periodic orbits&quot;])</code></pre><img src="6fa77376.svg" alt="Example block output"/><p>Finally, if you are interested in the periodic orbits saved in <code>br_po</code>, for example to plot it, the method <code>get_periodic_orbit</code> is what you are looking for:</p><pre><code class="language-julia hljs">sol = get_periodic_orbit(br_po, 10)
plot( sol.t, sol[1,:], label = &quot;u&quot;, xlabel = &quot;time&quot;)
plot!(sol.t, sol[2,:], label = &quot;v&quot;, xlabel = &quot;time&quot;)</code></pre><img src="af9b0bef.svg" alt="Example block output"/><h3 id="Plotting-the-periodic-orbit-during-continuation"><a class="docs-heading-anchor" href="#Plotting-the-periodic-orbit-during-continuation">Plotting the periodic orbit during continuation</a><a id="Plotting-the-periodic-orbit-during-continuation-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-the-periodic-orbit-during-continuation" title="Permalink"></a></h3><p>If you plot the solution during continuation, you see that the right bottom panel is empty ; this panel is used to plot the solution at the current continuation step:</p><pre><code class="language-julia hljs">br_po = continuation(br, 2, br.contparams,
        PeriodicOrbitOCollProblem(20, 5);
        plot = true,
        )</code></pre><img src="03c0ea21.svg" alt="Example block output"/><p>(Note that the bottom panel is a plot of the eigenvalues of the jacobian in the complex plane at the current continuation step. )</p><p>In order to plot the periodic solution during continuation, you need to supply a <code>periodic_solution</code> to <code>continuation</code>. This is not done by default because in some cases, obtaining the solution is costly (<em>e.g.</em> for Shooting methods). Based on the previous paragraph, it is straightforward to implement this plotting function:</p><pre><code class="language-julia hljs">br_po = continuation(br, 2, br.contparams,
        PeriodicOrbitOCollProblem(20, 5);
        plot = true,
        plot_solution = (x, par; k...) -&gt; begin
                # par is a Named tuple which contains
                # the problem for computing periodic orbits
                # and the value of the parameter at the current step
                sol = get_periodic_orbit(par.prob, x, par.p)
                plot!(sol.t, sol.u&#39;; xlabel = &quot;time&quot;, label=&quot;&quot;, k...)
        end
        )</code></pre><img src="ae2717e9.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../capabilities/">« Overview of capabilities</a><a class="docs-footer-nextpage" href="../tutorials/tutorials/">Tutorials »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.9.0 on <span class="colophon-date" title="Sunday 23 March 2025 14:28">Sunday 23 March 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
