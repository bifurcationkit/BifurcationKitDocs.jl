<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bifurcation diagram · Bifurcation Analysis in Julia</title><meta name="title" content="Bifurcation diagram · Bifurcation Analysis in Julia"/><meta property="og:title" content="Bifurcation diagram · Bifurcation Analysis in Julia"/><meta property="twitter:title" content="Bifurcation diagram · Bifurcation Analysis in Julia"/><meta name="description" content="Documentation for Bifurcation Analysis in Julia."/><meta property="og:description" content="Documentation for Bifurcation Analysis in Julia."/><meta property="twitter:description" content="Documentation for Bifurcation Analysis in Julia."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Bifurcation Analysis in Julia logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Bifurcation Analysis in Julia</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../capabilities/">Overview of capabilities</a></li><li><a class="tocitem" href="../gettingstarted/">Getting Started with BifurcationKit</a></li><li><a class="tocitem" href="../tutorials/tutorials/">Tutorials</a></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Basics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../guidelines/">Guidelines</a></li><li><a class="tocitem" href="../educational/">Educational introduction</a></li><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../plotting/">Plot functions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Problems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../BifProblem/">Bifurcation Problem</a></li><li><a class="tocitem" href="../diffeq/">DiffEq wrapper</a></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Periodic Orbits</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../periodicOrbit/">Introduction</a></li><li><a class="tocitem" href="../periodicOrbitTrapeze/">Trapezoid</a></li><li><a class="tocitem" href="../periodicOrbitCollocation/">Collocation</a></li><li><a class="tocitem" href="../periodicOrbitShooting/">Shooting</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Symmetries / Waves</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../intro_wave/">Introduction</a></li><li><a class="tocitem" href="../waveEigen/">Eigen Solvers</a></li><li><a class="tocitem" href="../ModulatedTW/">Modulated Travelling waves</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Continuation methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../IntroContinuation/">Introduction</a></li><li><a class="tocitem" href="../Predictors/">Predictors / correctors</a></li><li><a class="tocitem" href="../PALC/">PALC</a></li><li><a class="tocitem" href="../MooreSpence/">Moore-Penrose continuation</a></li><li><a class="tocitem" href="../ANM/">ANM</a></li><li><a class="tocitem" href="../DeflatedContinuation/">Deflated continuation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox" checked/><label class="tocitem" for="menuitem-8"><span class="docs-label">Functionalities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-1" type="checkbox"/><label class="tocitem" for="menuitem-8-1"><span class="docs-label">Nonlinear equations (Newton)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../newton/">Krylov-Newton algorithm</a></li><li><a class="tocitem" href="../deflatedproblem/">Deflated problems</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-2" type="checkbox"/><label class="tocitem" for="menuitem-8-2"><span class="docs-label">Bifurcations (equilibria)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../detectionBifurcation/">Bifurcation detection (1 param)</a></li><li><a class="tocitem" href="../codim2Continuation/">Fold / Hopf Continuation (2 params)</a></li><li><a class="tocitem" href="../codim3Continuation/">Bogdanov-Takens refinement (3 params)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-3" type="checkbox"/><label class="tocitem" for="menuitem-8-3"><span class="docs-label">Bifurcations (periodic orbits)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../detectionBifurcationPO/">Bifurcation detection (1 param)</a></li><li><a class="tocitem" href="../FoldContinuationPO/">Fold continuation (2 params)</a></li><li><a class="tocitem" href="../PDContinuationPO/">Period-Doubling continuation (2 params)</a></li><li><a class="tocitem" href="../NSContinuationPO/">Neimark-Sacker continuation (2 params)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-4" type="checkbox"/><label class="tocitem" for="menuitem-8-4"><span class="docs-label">Normal form (equilibria)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../simplebp/">Simple branch point</a></li><li><a class="tocitem" href="../nonsimplebp/">Non-simple branch point</a></li><li><a class="tocitem" href="../simplehopf/">Simple Hopf</a></li><li><a class="tocitem" href="../cusp/">Cusp</a></li><li><a class="tocitem" href="../bt/">Bogdanov-Takens</a></li><li><a class="tocitem" href="../bautin/">Bautin</a></li><li><a class="tocitem" href="../zh/">Zero-Hopf</a></li><li><a class="tocitem" href="../hh/">Hopf-Hopf</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-5" type="checkbox"/><label class="tocitem" for="menuitem-8-5"><span class="docs-label">Normal form (periodic orbits)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../bppo/">Simple branch point</a></li><li><a class="tocitem" href="../pd/">Period-doubling</a></li><li><a class="tocitem" href="../ns/">Neimark-Sacker</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-6" type="checkbox"/><label class="tocitem" for="menuitem-8-6"><span class="docs-label">Branch switching</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../intro-abs/">Introduction</a></li><li><a class="tocitem" href="../abs-from-eq/">From equilibria to equilibria</a></li><li><a class="tocitem" href="../abs-from-hopf/">From Hopf/PD/Branch to periodic orbits</a></li><li><a class="tocitem" href="../abs-from-codim2-eq/">From codim 2 to equilibria</a></li><li><a class="tocitem" href="../abs-from-codim2-po/">From codim 2 to periodic orbits</a></li></ul></li><li class="is-active"><a class="tocitem" href>Bifurcation diagram</a><ul class="internal"><li><a class="tocitem" href="#Pitfalls"><span>Pitfalls</span></a></li><li><a class="tocitem" href="#Basic-example-with-simple-branch-points"><span>Basic example with simple branch points</span></a></li><li><a class="tocitem" href="#Example-with-nonsimple-branch-points"><span>Example with nonsimple branch points</span></a></li><li><a class="tocitem" href="#Printing-the-structure-of-the-diagram"><span>Printing the structure of the diagram</span></a></li><li><a class="tocitem" href="#Plotting-the-structure-of-the-diagram"><span>Plotting the structure of the diagram</span></a></li></ul></li><li><a class="tocitem" href="../EventCallback/">Event handling and Callback</a></li><li><a class="tocitem" href="../iterator/">Iterator Interface</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Options</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../linearsolver/">Linear solvers</a></li><li><a class="tocitem" href="../borderedlinearsolver/">Bordered linear solvers</a></li><li><a class="tocitem" href="../eigensolver/">Eigen solvers</a></li><li><a class="tocitem" href="../Borderedarrays/">Bordered arrays</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Contributing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-10-1" type="checkbox"/><label class="tocitem" for="menuitem-10-1"><span class="docs-label">Interfaces</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../interfaceLS/">Vector</a></li><li><a class="tocitem" href="../interfaceLS/">Linear / eigen Solvers</a></li><li><a class="tocitem" href="../interfacePred/">Predictor / corrector</a></li><li><a class="tocitem" href="../interfaceFlow/">Flow</a></li></ul></li></ul></li><li><a class="tocitem" href="../faq/">Frequently asked questions</a></li><li><a class="tocitem" href="../migration/">Migration from old versions</a></li><li><a class="tocitem" href="../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Functionalities</a></li><li class="is-active"><a href>Bifurcation diagram</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bifurcation diagram</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/bifurcationkit/BifurcationKitDocs.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/bifurcationkit/BifurcationKitDocs.jl/blob/main/docs/src/BifurcationDiagram.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Automatic-Bifurcation-diagram-computation"><a class="docs-heading-anchor" href="#Automatic-Bifurcation-diagram-computation">Automatic Bifurcation diagram computation</a><a id="Automatic-Bifurcation-diagram-computation-1"></a><a class="docs-heading-anchor-permalink" href="#Automatic-Bifurcation-diagram-computation" title="Permalink"></a></h1><p>Thanks to the functionality presented in this part, we can compute the bifurcation diagram of a system recursively and <strong>fully automatically</strong>. More precisely, the function <code>bifurcationdiagram</code> allows to:</p><ul><li>compute a branch <span>$\gamma$</span> of equilibria</li><li>detect all bifurcations on the branch</li><li>recursively compute the branches emanating from branch points on <span>$\gamma$</span>.</li></ul><h2 id="Pitfalls"><a class="docs-heading-anchor" href="#Pitfalls">Pitfalls</a><a id="Pitfalls-1"></a><a class="docs-heading-anchor-permalink" href="#Pitfalls" title="Permalink"></a></h2><p>For now, there is no way to decide if two branches <span>$\gamma_1,\gamma_2$</span> are the same. As a consequence:</p><ul><li>there is no loop detection. Hence, if the branch <span>$\gamma$</span> has a component akin to a circle, you may experience a large number of branches</li><li>if the bifurcation diagram itself has loops (see example below), you may experience a large number of branches</li></ul><div class="admonition is-warning"><header class="admonition-header">Memory</header><div class="admonition-body"><p>The whole diagram is stored in RAM and you might be careful computing it on GPU. We&#39;ll add a file system for this in the future. </p></div></div><h2 id="Basic-example-with-simple-branch-points"><a class="docs-heading-anchor" href="#Basic-example-with-simple-branch-points">Basic example with simple branch points</a><a id="Basic-example-with-simple-branch-points-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-example-with-simple-branch-points" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Revise, Plots
using BifurcationKit

Fbp(u, p) = @. -u * (p + u * (2-5u)) * (p -.15 - u * (2+20u))

# bifurcation problem
prob = BifurcationProblem(Fbp, [0.0], -0.2,
	# specify the continuation parameter
	(@optic _);
	record_from_solution = (x, p) -&gt; x[1])

# options for newton
# we reduce a bit the tolerances to ease automatic branching
opt_newton = NewtonPar(tol = 1e-9)

# options for continuation
opts_br = ContinuationPar(dsmin = 0.001, dsmax = 0.005, ds = 0.001,
	newton_options = opt_newton,
	nev = 1,
	# parameter interval
	p_min = -1.0, p_max = .3,
	# detect bifurcations with bisection method
	# we increase here the precision for the detection of
	# bifurcation points
	n_inversion = 8)

diagram = bifurcationdiagram(prob, PALC(),
	# very important parameter. This specifies the maximum amount of recursion
	# when computing the bifurcation diagram. It means we allow computing branches of branches
	# at most in the present case.
	2,
	opts_br,
)

# You can plot the diagram like
plot(diagram; putspecialptlegend=false, markersize=2, plotfold=false, title = &quot;#branches = $(size(diagram))&quot;)</code></pre><img src="1b70c77c.svg" alt="Example block output"/><p>This gives</p><pre><code class="language-julia hljs">diagram</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[Bifurcation diagram]
 ┌─ From 0-th bifurcation point.
 ├─ Children number: 4
 └─ Root (recursion level 1)
      ┌─ Curve type: <span class="sgr36"><span class="sgr1">EquilibriumCont</span></span>
      ├─ Number of points: 76
      ├─ Type of vectors: <span class="sgr36"><span class="sgr1">Vector{Float64}</span></span>
      ├─ Parameter <span class="sgr36"><span class="sgr1">p</span></span> starts at -0.2, ends at 0.3
      ├─ Algo: <span class="sgr36"><span class="sgr1">PALC</span></span>
      └─ Special points:

- #  1, <span class="sgr34"><span class="sgr1">      bp</span></span> at p ≈ +0.00000281 ∈ (-0.00000065, +0.00000281), |δp|=3e-06, [<span class="sgr32"><span class="sgr1">converged</span></span>], δ = ( 1,  0), step =  31
- #  2, <span class="sgr34"><span class="sgr1">      bp</span></span> at p ≈ +0.15000016 ∈ (+0.14999995, +0.15000016), |δp|=2e-07, [<span class="sgr31"><span class="sgr1">   guessL</span></span>], δ = (-1,  0), step =  53
- #  3, <span class="sgr1">endpoint</span> at p ≈ +0.30000000,                                                                     step =  75
</code></pre><h2 id="Example-with-nonsimple-branch-points"><a class="docs-heading-anchor" href="#Example-with-nonsimple-branch-points">Example with nonsimple branch points</a><a id="Example-with-nonsimple-branch-points-1"></a><a class="docs-heading-anchor-permalink" href="#Example-with-nonsimple-branch-points" title="Permalink"></a></h2><p>To show the ability of the branch switching method to cope with non simple branch points, we look at the normal form of the Pitchfork with D6 symmetry which occurs frequently in problems with hexagonal symmetry. You may want to look at <a href="../tutorials/mittelmannAuto/#gelfandauto">Bratu–Gelfand problem</a> for a non trivial example of use.</p><pre><code class="language-julia hljs">using Revise, Plots
using BifurcationKit
const BK = BifurcationKit

function FbpD6(x, p)
	return [ p.μ * x[1] + (p.a * x[2] * x[3] - p.b * x[1]^3 - p.c*(x[2]^2 + x[3]^2) * x[1]),
		p.μ * x[2] + (p.a * x[1] * x[3] - p.b * x[2]^3 - p.c*(x[3]^2 + x[1]^2) * x[2]),
		p.μ * x[3] + (p.a * x[1] * x[2] - p.b * x[3]^3 - p.c*(x[2]^2 + x[1]^2) * x[3])]
end

# model parameters
pard6 = (μ = -0.2, a = 0.3, b = 1.5, c = 2.9)

# problem
prob = BifurcationProblem(FbpD6, zeros(3), pard6, (@optic _.μ);
		record_from_solution = (x, p) -&gt; (n = norminf(x)))

# newton options
opt_newton = NewtonPar(tol = 1e-9, max_iterations = 20)

# continuation options
opts_br = ContinuationPar(
	# we limit the step size to have smooth branches
	dsmax = 0.005, ds = 0.001,
	# parameter interval
	p_max = 0.4, p_min = -0.25,
	# number of eigenvalues to be computed
	nev = 3,
	newton_options = opt_newton,
	max_steps = 1000,
	# increased precision for bifurcation points
	n_inversion = 4, max_bisection_steps = 20)

diagram = bifurcationdiagram(prob, PALC(), 3,
	opts_br;
	normC = norminf)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[Bifurcation diagram]
 ┌─ From 0-th bifurcation point.
 ├─ Children number: 2
 └─ Root (recursion level 1)
      ┌─ Curve type: <span class="sgr36"><span class="sgr1">EquilibriumCont</span></span>
      ├─ Number of points: 89
      ├─ Type of vectors: <span class="sgr36"><span class="sgr1">Vector{Float64}</span></span>
      ├─ Parameter <span class="sgr36"><span class="sgr1">μ</span></span> starts at -0.2, ends at 0.4
      ├─ Algo: <span class="sgr36"><span class="sgr1">PALC</span></span>
      └─ Special points:

- #  1, <span class="sgr34"><span class="sgr1">      nd</span></span> at μ ≈ +0.00019961 ∈ (-0.00024233, +0.00019961), |δp|=4e-04, [<span class="sgr32"><span class="sgr1">converged</span></span>], δ = ( 3,  0), step =  31
- #  2, <span class="sgr1">endpoint</span> at μ ≈ +0.40000000,                                                                     step =  88
</code></pre><p>We can now plot the result:</p><pre><code class="language-julia hljs">plot(diagram; putspecialptlegend =false, markersize=2, plotfold=false, title=&quot;#branch = $(size(diagram))&quot;)</code></pre><img src="bc6694ab.svg" alt="Example block output"/><p>We can access the different branches with <code>BK.getBranch(diagram, (1,))</code>. Alternatively, you can plot a specific branch:</p><p><img src="../diagramD6b.png" alt/></p><p>Finally, you can resume the computation of the bifurcation diagram if not complete by using the syntax</p><pre><code class="language-julia hljs">BK.bifurcationdiagram!(prob,
	# this resume the computation of the diagram from the 2nd node
	# diagram is written inplace
	get_branch(diagram, (2,)), 6,
	(args...) -&gt; opts_br)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[Bifurcation diagram]
 ┌─ From 1-th bifurcation point.
 ├─ Children number: 4
 └─ Root (recursion level 2)
      ┌─ Curve type: <span class="sgr36"><span class="sgr1">EquilibriumCont from NonSimpleBranchPoint bifurcation point.</span></span>
      ├─ Number of points: 79
      ├─ Type of vectors: <span class="sgr36"><span class="sgr1">Vector{Float64}</span></span>
      ├─ Parameter <span class="sgr36"><span class="sgr1">μ</span></span> starts at 0.00019960742344131129, ends at 0.4
      ├─ Algo: <span class="sgr36"><span class="sgr1">PALC</span></span>
      └─ Special points:

- #  1, <span class="sgr34"><span class="sgr1">      nd</span></span> at μ ≈ +0.00000131 ∈ (+0.00000131, +0.00019961), |δp|=2e-04, [<span class="sgr31"><span class="sgr1">    guess</span></span>], δ = (-2,  0), step =   1
- #  2, <span class="sgr34"><span class="sgr1">      bp</span></span> at μ ≈ +0.06889046 ∈ (+0.06884936, +0.06889046), |δp|=4e-05, [<span class="sgr32"><span class="sgr1">converged</span></span>], δ = (-1,  0), step =  24
- #  3, <span class="sgr1">endpoint</span> at μ ≈ +0.40000000,                                                                     step =  78
</code></pre><h2 id="Printing-the-structure-of-the-diagram"><a class="docs-heading-anchor" href="#Printing-the-structure-of-the-diagram">Printing the structure of the diagram</a><a id="Printing-the-structure-of-the-diagram-1"></a><a class="docs-heading-anchor-permalink" href="#Printing-the-structure-of-the-diagram" title="Permalink"></a></h2><p>It is sometimes useful to have a global representation of the bifurcation diagram. Here, we provide a text representation</p><pre><code class="language-julia hljs">using AbstractTrees

AbstractTrees.children(node::BK.BifDiagNode) = node.child

## Things that make printing prettier
AbstractTrees.printnode(io::IO, node::BifDiagNode) = print(io, &quot;$(node.code) [ $(node.level)]&quot;)

print_tree(diagram)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0 [ 1]
├─ 1 [ 2]
│  ├─ 2 [ 3]
│  ├─ 2 [ 3]
│  ├─ 4 [ 3]
│  ├─ 4 [ 3]
│  ├─ 4 [ 3]
│  ├─ 4 [ 3]
│  ├─ 4 [ 3]
│  └─ 4 [ 3]
└─ 1 [ 2]
   ├─ 2 [ 3]
   ├─ 2 [ 3]
   ├─ 2 [ 3]
   └─ 2 [ 3]</code></pre><h2 id="Plotting-the-structure-of-the-diagram"><a class="docs-heading-anchor" href="#Plotting-the-structure-of-the-diagram">Plotting the structure of the diagram</a><a id="Plotting-the-structure-of-the-diagram-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-the-structure-of-the-diagram" title="Permalink"></a></h2><p>We can also use <code>GraphPlot</code> to plot the tree underlying the bifurcation diagram:</p><pre><code class="language-julia hljs">using LightGraphs, MetaGraphs, GraphPlot

function graphFromDiagram!(_graph, diagram, indp)
	# ind is the index of the parent node
	# add vertex and associated information
	add_vertex!(_graph)
	set_props!(_graph, nv(_graph), Dict(:code =&gt; diagram.code, :level =&gt; diagram.level))
	if nv(_graph) &gt; 1
		add_edge!(_graph, indp, nv(_graph))
	end
	if length(diagram.child) &gt; 0
		# we now run through the children
		new_indp = nv(_graph)
		for diag in diagram.child
			graphFromDiagram!(_graph, diag, new_indp)
		end
	end
end

function graphFromDiagram(diagram) 
	_g = MetaGraph()
	graphFromDiagram!(_g, diagram, 1)
	return _g
end

_g = graphFromDiagram(bdiag)

gplot(_g, nodelabel = [props(_g, ve)[:code] for ve in vertices(_g)])</code></pre><p>which gives the following picture. The node label represent the index of the bifurcation point from which the branch branches.</p><h3 id="Using-GraphRecipes"><a class="docs-heading-anchor" href="#Using-GraphRecipes">Using <code>GraphRecipes</code></a><a id="Using-GraphRecipes-1"></a><a class="docs-heading-anchor-permalink" href="#Using-GraphRecipes" title="Permalink"></a></h3><p>Another solution is to use <code>GraphRecipes</code> and </p><pre><code class="language-julia hljs">using GraphRecipes

graphplot(_g, 
	node_weights = ones(nv(_g)).*10, 
	names=[props(_g, ve)[:code] for ve in vertices(_g)], 
	curvature_scalar=0.)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../abs-from-codim2-po/">« From codim 2 to periodic orbits</a><a class="docs-footer-nextpage" href="../EventCallback/">Event handling and Callback »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 5 September 2024 22:47">Thursday 5 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
